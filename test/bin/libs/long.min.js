window.long={},function(t){class e{}e.result=0,e.isWxmj=!1,e.isGaming=!1,e.is4399=!1,e.MouseModel=!1,e.is233=!1,e.isAndroidOppo=!1,e.isAndroidVivo=!1,e.isAndroidMZ=!1,e.isAndroid4399=!1,e.isAndroidcsj=!1,e.isAndroidxm=!1,t.Global=e}(long||(long={})),function(t){class e{}e.width=1280,e.height=720,e.scaleMode=Laya.Stage.SCALE_FIXED_HEIGHT,e.screenMode=Laya.Stage.SCREEN_HORIZONTAL,e.isPortrait=!0,e.alignV="top",e.alignH="left",e.startScene="test/TestScene.scene",e.sceneRoot="",e.debug=!1,e.stat=!1,e.physicsDebug=!1,e.exportSceneToJson=!0,e.isDown=!1,e.isMove=!1,e.scale=1,e.scaleTime=.3,e.moveSpeed=.2,e.viewWidth=0,e.viewHeight=0,e.Font_Normal="Microsoft YaHei",e.isFirstLogin=!1,e.useGM=!1,e.drawRect=!1,e.printLog=!0,e.scene_scale=1,e.FPS=1/60,e.isActive=!0,t.GlobalConfig=e}(long||(long={})),function(t){class e{constructor(){}static log(t,s){e.isShowLog&&e.outPut("[log] ["+e.getClassName(t)+"] "+s)}static debug(t,s){let i="[debug] ["+e.getClassName(t)+"] "+s;Laya.Browser.onHWMiniGame||Laya.Browser.onTTMiniGame||Laya.Browser.onMiniGame||Laya.Browser.onVVMiniGame?console.info(i):console.debug(i)}static net(t,s){e.isShowLog&&e.isNet&&e.outPut("[net] ["+e.getClassName(t)+"] "+s)}static error(t,s){let i="[debug] ["+e.getClassName(t)+"] "+s;console.error(i)}static warning(t,s){e.isShowLog&&e.outPut("[warning] ["+e.getClassName(t)+"] "+s)}static outPut(t){console.info(t)}static getClassName(t){if("string"==typeof t)return t;if(t&&"Function"===t.constructor.name){if(t.name)return t.name;console.error("Logger.getClassName 错误!!!")}return t&&t.constructor.name}}e.isNet=!1,e.isShowLog=!1,t.Logger=e}(long||(long={})),function(t){t.ActionNoQueue=class{constructor(t=0){this.maxCount=0,this.actions=new Array,this.maxCount=t}advanceTime(){if(0==this.actions.length)return void t.GlobalJugger.remove(this);let e=0==this.maxCount||this.actions.length<this.maxCount?this.actions.length:this.maxCount;for(let s=0;s<e;s++){let i=this.actions[s];i.IsComplete()?(i.OnComplete(),i.GC(),t.ArrayUtil.RemoveAt(this.actions,s),s--,e--):i.advanceTime()}}ClearAll(){for(let t of this.actions)t.GC();this.actions.length=0}AddAction(e){null!=e&&(this.actions.push(e),1==this.actions.length&&t.GlobalJugger.add(this),e.Run())}RemoveAction(t){var e=this.actions.indexOf(t);-1!=e&&(this.actions.splice(e,1),0==this.actions.length&&Laya.timer.clear(this,this.advanceTime))}IsEmpty(){return 0==this.actions.length}}}(long||(long={})),function(t){t.ActionQueue=class{constructor(){this.actions=new Array,this.curAction=null,this.handler=null}advanceTime(){if(0==this.actions.length)return t.GlobalJugger.remove(this),void(null!=this.handler&&this.handler.run());if(null==this.curAction)return this.curAction=this.actions[0],void this.curAction.Run();if(this.curAction.IsComplete()){let t=this.actions.shift();t.OnComplete(),t.GC(),this.curAction=null}else this.curAction.advanceTime()}ClearAll(){for(let t of this.actions)t.GC();this.actions.length=0,this.handler=null,this.curAction=null}AddAction(e){null!=e&&(this.actions.push(e),1==this.actions.length&&t.GlobalJugger.add(this))}RemoveAction(t){var e=this.actions.indexOf(t);-1!=e&&(this.actions.splice(e,1),0==this.actions.length&&Laya.timer.clear(this,this.advanceTime))}RemoveActionByCls(t){for(let e=0;e<this.actions.length;e++){this.actions[e]instanceof t&&this.actions.splice(e,1)}}IsEmpty(){return 0==this.actions.length}}}(long||(long={})),function(t){t.BaseAction=class{constructor(){this.cls=null,this.complete=null,this.m_isComplete=!1}Run(){}advanceTime(){}IsComplete(){return this.m_isComplete}OnComplete(){null!=this.complete&&this.complete.run()}Reset(){this.cls=null,this.complete=null,this.m_isComplete=!1}GC(){}}}(long||(long={})),function(t){class e extends t.BaseAction{constructor(){super(),this.url=null,this.handler=null,this.level=t.LoadLevel.DEFAULT}Run(){super.Run(),t.LoadQueue.Inst.loadAnimationClip(this.url,Laya.Handler.create(this,this.onLoadComplete),!1,this.level)}onLoadComplete(t){this.handler&&(this.handler.runWith(t),this.handler=null),this.m_isComplete=!0}Reset(){super.Reset(),this.url=null,this.handler=null}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="LoadAnimationAction",t.LoadAnimationAction=e}(long||(long={})),function(t){class e extends t.BaseAction{constructor(){super(),this.url=null,this.handler=null,this.level=t.LoadLevel.DEFAULT}Run(){super.Run(),t.LoadQueue,t.LoadQueue.Inst.loadSprite3D(this.url,Laya.Handler.create(this,this.onLoadComplete),this.level)}onLoadComplete(t){this.handler&&(this.handler.runWith(t),this.handler=null),this.m_isComplete=!0}Reset(){super.Reset(),this.url=null,this.handler=null}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="LoadSprite3dAction",t.LoadSprite3dAction=e}(long||(long={})),function(t){class e extends fgui.GComponent{constructor(){super(),this.spineName=null,this.mFactory=null,this.skeleton=null,this.isLoop=!0,this.isOverRemove=!1,this.handler=null,this.loadComplete=null,this.touchable=!1}play(e,s=!0,i=!1,a=null,n=null,r=!1){let l=this;if(l.spineName==e)return;l.clear(),l.spineName=e,l.isLoop=s,l.isOverRemove=i,l.handler=a;let o=t.UrlUtils.GetSpineUrl(e);l.mFactory=new Laya.Templet,l.mFactory.once(Laya.Event.COMPLETE,this,this.onComplete,[n]),l.mFactory.loadAni(o)}onComplete(t){this.skeleton=this.mFactory.buildArmature(0),this.displayObject.addChild(this.skeleton),this.skeleton.pos(0,0),this.skeleton.play(null==t||""==t?0:t,this.isLoop),this.isLoop||this.skeleton.once(Laya.Event.STOPPED,this,this.completeHandler),null!=this.loadComplete&&(this.loadComplete.run(),this.loadComplete=null),this.updateGray()}updateGray(){this.skeleton&&fgui.ToolSet.setColorFilter(this.skeleton,this.grayed)}showSkinByName(t){this.skeleton&&this.skeleton.showSkinByName(t)}completeHandler(){null!=this.handler&&this.handler.run(),this.isOverRemove&&this.clear()}PlayAni(t,e=!0,s=null){this.skeleton&&this.skeleton.templet&&(this.skeleton.play(null==t||""==t?0:t,e),e||null==s||this.skeleton.once(Laya.Event.STOPPED,null,(function(){s.run()})))}stop(){this.skeleton&&(this.skeleton.index=0,this.skeleton.stop())}get skeletonWidth(){return this.skeleton?this.skeleton.width:0}get skeletonHeight(){return this.skeleton?this.skeleton.height:0}get isLoaded(){return null!=this.skeleton}get SpineName(){return this.spineName}clear(){if(this.spineName=null,this.isLoop=!0,this.isOverRemove=!1,this.loadComplete&&this.loadComplete.recover(),this.handler=null,this.loadComplete=null,this.displayObject.removeChildren(),null!=this.mFactory&&(this.mFactory.off(Laya.Event.COMPLETE,this,this.onComplete,!1),this.mFactory=null),null!=this.skeleton){this.skeleton.off(Laya.Event.STOPPED,this,this.completeHandler,!1);try{this.skeleton.destroy(!1)}catch(t){}this.skeleton=null}}dispose(){this.clear(),this.removeFromParent()}}t.SkeletonAnimation=e}(long||(long={})),function(t){t.Bezier=class{constructor(){}SetPoints(t){if(t.length<2)throw new Error("实例化贝塞尔曲线至少需要2个点");this.m_Points=new Array,this.createdLine=new Array,this.CreateLine(t)}AddPoint(t){this.m_Points.push(t),this.CreateLine(this.m_Points)}AddPointAt(t,e){if(!(t>=0&&t<this.m_Points.length))throw new Error("索引超出范围");this.m_Points.splice(t,0,e),this.CreateLine(this.m_Points)}RemovePoint(t){if(this.m_Points.length>2)for(var e=0;e<this.m_Points.length;e++)this.m_Points[e]==t&&(this.m_Points.splice(e,1),this.CreateLine(this.m_Points));else new Error("当前曲线锚点数量已经最低，不能移除锚点")}RemovePointAt(t){this.m_Points.length>2?(this.m_Points.splice(t,1),this.CreateLine(this.m_Points)):new Error("当前曲线锚点数量已经最低，不能移除锚点")}UpdatePoint(t,e){if(t<0)throw new Error("坐标索引参数错误（取值必须大于0）");if(t>=this.m_Points.length)throw new Error("坐标索引参数错误（取值必须x小于曲线顶点的个数）");this.m_Points[t]=e,this.CreateLine(this.m_Points)}GetPoint(t){new Laya.Vector3;t<0?t=0:t>1&&(t=1);var e=this.createdLine;if(null==e)throw new Error("曲线锚点为空");for(;e.length>1;)e=this.CaculateResoultLine(e,t);if(1!=e.length)throw new Error("Program Error : Current Line Count is:   "+e.length);return e[0].GetPoint(t)}CaculateResoultLine(e,s){let i=new Array;for(var a=0;a<e.length-1;a++){var n=a+1;let r=new t.Line(e[a].GetPoint(s),e[n].GetPoint(s));i.push(r)}return i}CreateLine(e){this.createdLine=new Array,this.m_Points=e;for(var s=0;s<e.length;s++){let i=s+1;if(i>=e.length)break;{let a=new t.Line(e[s],e[i]);this.createdLine.push(a)}}}}}(long||(long={})),function(t){t.Bezier2D=class{constructor(t,e,s,i,a=Laya.Ease.linearIn,n=null){this.obj=null,this.passtime=0,this.delayTime=0,this.resultPos=null,this.obj=t,this.delayTime=s,this.time=e,this.points=i,this.resultPos=new Laya.Point,this.ease=a,this.handler=n}start(){Laya.timer.frameLoop(1,this,this.fly),this.passtime=0}fly(){if(this.passtime+=Laya.timer.delta,!(this.passtime<=this.delayTime))if(this.passtime-this.delayTime>this.time){Laya.timer.clear(this,this.fly);try{this.obj.removeSelf()}catch(t){this.obj.removeFromParent()}this.handler&&this.handler.run()}else if(null!=this.obj&&this.points.length>1){let e=this.ease(this.passtime-this.delayTime,0,1,this.time);t.MathUtil.GetBezierPoint(this.points,e,this.resultPos),this.obj.x=this.resultPos.x,this.obj.y=this.resultPos.y}}}}(long||(long={})),function(t){class e extends Laya.Script3D{constructor(){super(),this.transform=null,this.bezierCurve=null,this.moveTime=0,this.startTime=0,this.randomAngle=null,this.handler=null,this.isRemove=!1}onAwake(){this.bezierCurve=new t.Bezier,this.transform=this.owner.transform}Play(t,e,s=null,i=!0){this.moveTime=e,this.bezierCurve.SetPoints(t),this.startTime=.001*Laya.timer.currTimer,this.randomAngle=new Laya.Vector3(0,6*Math.random()-3,6*Math.random()-3),this.handler=s,this.isRemove=i}onUpdate(){if(null==this.bezierCurve)return;let t=(.001*Laya.timer.currTimer-this.startTime)/this.moveTime;t<=1?this.transform.position=this.bezierCurve.GetPoint(t):(this.handler&&(this.handler.run(),this.handler=null),this.isRemove&&this.destroy())}Reset(){this.handler&&(this.handler.recover(),this.handler=null)}}t.BezierScript=e}(long||(long={})),function(t){t.Line=class{constructor(t,e){this._StartPoint=null,this._EndPoint=null,this.StartPoint=t,this.EndPoint=e}set StartPoint(t){this._StartPoint=t}get StartPoint(){return this._StartPoint}set EndPoint(t){this._EndPoint=t}get EndPoint(){return this._EndPoint}isMe(t){return this.StartPoint==t||this.EndPoint==t}GetPoint(t){var e=new Laya.Vector3;return t<0?t=0:t>1&&(t=1),e.x=this.EndPoint.x-this.StartPoint.x,e.y=this.EndPoint.y-this.StartPoint.y,e.z=this.EndPoint.z-this.StartPoint.z,e.x*=t,e.y*=t,e.z*=t,e.x+=this.StartPoint.x,e.y+=this.StartPoint.y,e.z+=this.StartPoint.z,e}}}(long||(long={})),function(t){class e{constructor(){this.wxSceneId=-1,this.enterGameCount=0,this.loginTime=0,this.todayFirstTime=0,this.isMusicOn=0,this.isSoundOn=0,this.cacheCheckData=null,this.passData=null,this.resetCount=0,this.stamina=0,this.skin=0,this.allSkins=[],this.useKeybord=0,this.unlockAll=0,this.curLevelId=1}}t.ForeverData=e;class s{constructor(){this.viewFreeAdCount=0}}t.DayData=s;class i{constructor(){this._foreverData=null,this._dayData=null,this.todayIsFirst=!1}static get Inst(){return null==this.inst&&(this.inst=new i),this.inst}get foreverData(){return this._foreverData}get dayData(){return this._dayData}init(s,a=null,n=null){let r=Laya.LocalStorage.getJSON(i.SAVE_KEY)||{};if(this._foreverData=null!=a?new a:new e,r)try{let e="string"==typeof r?JSON.parse(r):r;for(let t in e)this._foreverData[t]=e[t];t.Logger.debug(this,"=====>common savedata:"+JSON.stringify(this._foreverData)),this._foreverData.cacheCheckData=e.cacheCheckData||{},this._foreverData.passData=e.passData||{},this._foreverData.resetCount=e.resetCount||3,this._foreverData.skin=e.skin||1,this._foreverData.allSkins=e.allSkins||[1],0==this._foreverData.loginTime&&(this._foreverData.resetCount=3,this._foreverData.stamina=10),Laya.timer.once(200,this,this.initDay,[s,n])}catch(e){t.Logger.debug(this,"=====>永久数据解析错误 error: "+e),s&&s.runWith(!1)}}initDay(e,a=null){this._dayData=null!=a?new a:new s;let n=Laya.LocalStorage.getJSON(i.SAVE_KEY_DAY)||{};try{let s="string"==typeof n?JSON.parse(n):n;for(let t in s)this._dayData[t]=s[t];0==this._foreverData.loginTime&&(this._dayData.viewFreeAdCount=0),this.setLoginTime(),Laya.timer.loop(1e3,this,()=>{let e=this._foreverData.todayFirstTime;this.judgeIsOneDay(e)||(this.setLoginTime(),t.GameDispatcher.Inst.event(t.UIGameEvent.SKIP_DAY))}),e&&e.runWith(!0)}catch(s){t.Logger.debug(this,"=====>每日数据解析错误 error: "+s),e&&e.runWith(!1)}}setLoginTime(){let e=t.TimeUtil.getLocalTime();0==this._foreverData.todayFirstTime?(this._foreverData.todayFirstTime=e,this.todayIsFirst=!0,this.ClearDayAll()):this.judgeIsOneDay(this._foreverData.todayFirstTime)||(this._foreverData.todayFirstTime=e,this.todayIsFirst=!0,this.ClearDayAll()),this._foreverData.loginTime,this.todayIsFirst&&(this._foreverData.stamina+=5),this._foreverData.loginTime=e,this.SaveToDisk()}judgeIsOneDay(t){let e=new Date,s=e.getDay(),i=e.getFullYear(),a=e.getMonth();e.setTime(t);let n=e.getDay(),r=e.getFullYear(),l=e.getMonth();return i==r&&a==l&&s==n}get wxSceneId(){return(this._foreverData&&this._foreverData.wxSceneId)+""}GetMusic(){return 0==this._foreverData.isMusicOn}GetSound(){return 0==this._foreverData.isSoundOn}setCacheLevel(e,s){null==this._foreverData.cacheCheckData&&(this._foreverData.cacheCheckData={}),this._foreverData.cacheCheckData[e]=s,t.Logger.debug(this,"====>缓存关卡数据 level: "+e+" data: "+JSON.stringify(s)),this.SaveToDisk()}getCacheLevel(t){return this._foreverData.cacheCheckData&&this._foreverData.cacheCheckData[t]}get isNewer(){if(this._foreverData.passData)for(const t in this._foreverData.passData)if(t)return!1;return!0}getPassLevel(t){return this._foreverData.passData?this._foreverData.passData[t]:null}costResetCount(t=1){return this._foreverData.resetCount>=t&&(this._foreverData.resetCount-=t,this.SaveToDisk(),!0)}SaveToDisk(){Laya.timer.clear(this,this.saveForeveData),Laya.timer.once(200,this,this.saveForeveData)}saveForeveData(){let t=JSON.stringify(this._foreverData);Laya.LocalStorage.setJSON(i.SAVE_KEY,t)}SaveDayToDisk(){Laya.timer.clear(this,this.saveDayData),Laya.timer.once(200,this,this.saveDayData)}saveDayData(){let t=JSON.stringify(this._dayData);Laya.LocalStorage.setJSON(i.SAVE_KEY_DAY,t)}ClearDayAll(){this._dayData.viewFreeAdCount=0,Laya.LocalStorage.setJSON(i.SAVE_KEY_DAY,"{}")}clearAll(){Laya.LocalStorage.setJSON(i.SAVE_KEY,"{}"),Laya.LocalStorage.setJSON(i.SAVE_KEY_DAY,"{}"),Laya.LocalStorage.clear()}}i.SAVE_KEY="ForeverSaveData",i.SAVE_KEY_DAY="DaySaveData",i.inst=null,t.LocalCache=i}(long||(long={})),function(t){class e{constructor(t,e,s,i){this.type=t,this.listener=e,this.thisObject=s,this.target=i}static create(s,i,a,n){let r=t.ObjectPools.Inst.getObj(e.KEY,e);return r.type=s,r.listener=i,r.thisObject=a,r.target=n,r}static recover(s){t.ObjectPools.Inst.gcObj(e.KEY,s)}addListen(){this.type&&(this.target?(this.target.off(this.type,this.thisObject,this.listener),this.target.on(this.type,this.thisObject,this.listener)):(t.GameDispatcher.Inst.off(this.type,this.thisObject,this.listener),t.GameDispatcher.Inst.on(this.type,this.thisObject,this.listener)))}removeListen(){this.type&&(this.target?this.target.off(this.type,this.thisObject,this.listener):t.GameDispatcher.Inst.off(this.type,this.thisObject,this.listener))}Reset(){this.removeListen(),this.type=null,this.listener=null,this.thisObject=null,this.target=null}GC(){e.recover(this)}}e.KEY="ObjectPool.EventObj",t.EventObj=e}(long||(long={})),function(t){t.EventPool=class{constructor(){this.pool=null,this.pool=new Array}AddListenerInPool(t,e,s,i){this.addListener(t,e,s,i)}RemoveListenerFromPool(t,e,s,i){let a=this.getEventObj(t,e,i,s);a&&a.removeListen()}ClearListenerFromPool(){this.removeAllListener()}addListener(e,s,i,a){let n=this.getEventObj(e,s,a,i);null==n&&(n=t.EventObj.create(e,s,i,a),this.pool.push(n)),n.addListen()}removeAllListener(){let t,e=this.pool.length;for(let s=0;s<e;s++)t=this.pool[s],t.removeListen()}getEventObj(t,e,s,i){let a=null;for(a of this.pool)if(a&&a.type==t&&a.listener==e)return s&&a.target!=s||i&&a.thisObject!=i?null:a;return null}hasEventListener(t,e,s,i){return null!=this.getEventObj(t,e,s,i)}Reset(){if(null!=this.pool){let t;for(t of this.pool)t&&t.GC();this.pool.length=0}}}}(long||(long={})),function(t){class e extends Laya.EventDispatcher{constructor(){super()}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}}e._Inst=null,t.GameDispatcher=e}(long||(long={})),function(t){t.BaseState=class{constructor(t){this.id=t}GetNextState(){return this.isFinished?this.nextState:0}OnEnter(t,e){this.isFinished=!1,this.nextState=0,this.passTime=0,this.deltaTime=0,this._DoEnter(t,e)}OnRunning(t,e){this.isFinished||(this.deltaTime=e,this.passTime+=e,this._DoRunning(t))}OnExit(t,e){this._DoExit(t,e)}OnLateUpdate(t){this.isFinished||this._DoLateUpdate(t)}_DoLateUpdate(t){}_DoEnter(t,e){}_DoRunning(t){}_DoExit(t,e){}}}(long||(long={})),function(t){t.StateMachine=class{constructor(){this._states=new t.LTDictionary}get count(){return this._states.length}Add(t){this._states.set(t.id,t)}Remove(t){return this._states.remove(t)}RemoveAll(){this._states.clear(),this.currState=null}ExitCurrState(t=null){null!=this.currState&&(this.currState.OnExit(null,t),this.currState=null)}ChangeState(t,e=null){var s=this.Find(t);return null!=s?(null!=this.currState&&this.currState.OnExit(s,e),this.lastState=this.currState,this.currState=s,s.OnEnter(this.lastState,e),!0):(console.error("不存在的状态ID:"+t),!1)}LogicUpdate(t){let e=this.currState.GetNextState();0!=e&&this.ChangeState(e),this.OnRunning(null,t)}OnRunning(t,e){null!=this.currState&&this.currState.OnRunning(t,e)}Find(t){return this._states.get(t)}}}(long||(long={})),function(t){t.HttpUrl=class{constructor(){this.m_success=null,this.m_fail=null,this.m_url=null,this.index=0,this.xhr=null}sendGet(t,e=null,s=null){this.m_url=t,this.m_success=e,this.m_fail=s,this.xhr=new Laya.HttpRequest,this.xhr.http.timeout=1e4,this.xhr.once(Laya.Event.COMPLETE,this,this.completeHandler),this.xhr.once(Laya.Event.ERROR,this,this.errorHandler),this.xhr.send(t,"","get","text")}errorHandler(t){this.clear(),this.index++,this.index>=3?null!=this.m_fail&&this.m_fail.run():this.sendGet(this.m_url,this.m_success,this.m_fail)}completeHandler(t){this.clear(),null!=this.m_success&&this.m_success.runWith(t)}clear(){this.xhr.off(Laya.Event.COMPLETE,this,this.completeHandler),this.xhr.off(Laya.Event.ERROR,this,this.completeHandler)}sendPost(t,e,s=null,i=null){this.m_url=t,this.m_success=s,this.m_fail=i;const a=new XMLHttpRequest;a.open("POST",t,!0),a.setRequestHeader("Content-Type","application/json; charset=utf-8");const n=JSON.stringify(e);a.send(n),a.onload=function(){if(200==a.status){const t=JSON.parse(a.responseText);s.runWith(t)}else console.error("请求api失败!"+a.status),i.runWith(a.status)}}}}(long||(long={})),function(t){class e{constructor(t){this.animatinArr=new Array,this.lastTime=0,this.fps=t,this.frameTime=1/t}advanceTime(){let e=this;if(e.lastTime+=t.GlobalJugger.delta,e.lastTime>=e.frameTime){let t=Math.floor(e.lastTime/e.frameTime);e.lastTime=e.lastTime%e.frameTime;for(var s=e.animatinArr.length-1;s>=0;s--)e.animatinArr[s].UpdateFrame(t)}}add(e){-1==this.animatinArr.indexOf(e)&&(0==this.animatinArr.length&&t.GlobalJugger.add(this),this.animatinArr.push(e))}remove(e){var s=this.animatinArr.indexOf(e);-1!=s&&(this.animatinArr.splice(s,1),0==this.animatinArr.length&&t.GlobalJugger.remove(this))}}e.global=new e(12),t.AnimationJugger=e}(long||(long={})),function(t){class e{constructor(){this.delayArr=new Array}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}UpdateFrame(t){this.delayArr.length<=0||(this.delayArr[0].run(),this.removeAt(0))}add(e){-1==this.delayArr.indexOf(e)&&(0==this.delayArr.length&&t.AnimationJugger.global.add(this),this.delayArr.push(e))}remove(t){var e=this.delayArr.indexOf(t);-1!=e&&this.removeAt(e)}removeAt(e){this.delayArr.splice(e,1),0==this.delayArr.length&&t.AnimationJugger.global.remove(this)}}t.FrameQueueJugger=e}(long||(long={})),function(t){class e{constructor(){this.delayFrame=0,this.handler=null,this._frame=0}addFame(e){this._frame+=e,this._frame>=this.delayFrame&&(null!=this.handler&&this.handler.run(),t.KeyFrameJugger.Inst.remove(this))}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}Reset(){this.delayFrame=0,this.handler=null}}e.KEY="FrameVO",t.FrameVO=e}(long||(long={})),function(t){class e{}e.UPDATE_FPS="UPDATE_FPS",t.JuggerEvent=e;class s{constructor(){}static start(){Laya.timer.frameLoop(1,this,this.entter_frame),s.timeMS=Laya.timer.currTimer}static stop(){Laya.timer.clear(this,this.entter_frame)}static entter_frame(){if(!t.GlobalConfig.isActive)return s.fps=s.checkFps60,void(s.checkLastTime=0);s.delta=Laya.timer.delta,this.CheckFps(),s.delta>s.fps&&(s.delta=s.fps),s.timeMS+=s.delta,s.time=.001*s.timeMS;for(let t of s.animatinArr)t.advanceTime()}static CheckFps(){return s.delta>=s.checkFps20?s.fps==s.checkFps20?void(s.checkLastTime=0):(s.checkLastTime+=s.delta,void(s.checkLastTime>s.checkFpsTime&&(s.fps=s.checkFps20,s.checkLastTime=0,t.GameDispatcher.Inst.event(e.UPDATE_FPS,s.checkFps20)))):s.delta>=s.checkFps30?s.fps==s.checkFps30?void(s.checkLastTime=0):(s.checkLastTime+=s.delta,void(s.checkLastTime>s.checkFpsTime&&(s.fps=s.checkFps30,s.checkLastTime=0,t.GameDispatcher.Inst.event(e.UPDATE_FPS,s.checkFps30)))):s.delta>=s.checkFps45?s.fps==s.checkFps45?void(s.checkLastTime=0):(s.checkLastTime+=s.delta,void(s.checkLastTime>s.checkFpsTime&&(s.fps=s.checkFps45,s.checkLastTime=0,t.GameDispatcher.Inst.event(e.UPDATE_FPS,s.checkFps45)))):s.delta>=s.checkFps60?s.fps==s.checkFps60?void(s.checkLastTime=0):(s.checkLastTime+=s.delta,void(s.checkLastTime>s.checkFpsTime&&(s.fps=s.checkFps60,s.checkLastTime=0,t.GameDispatcher.Inst.event(e.UPDATE_FPS,s.checkFps60)))):void 0}static add(t){-1==this.animatinArr.indexOf(t)&&(0==this.animatinArr.length&&this.start(),this.animatinArr.push(t))}static remove(e){var s=this.animatinArr.indexOf(e);-1!=s&&(t.ArrayUtil.RemoveAt(this.animatinArr,s),0==this.animatinArr.length&&this.stop())}}s.timeMS=0,s.time=0,s.delta=0,s.animatinArr=new Array,s.fps=1/60*1e3,s.checkLastTime=0,s.checkFpsTime=1e4,s.checkFps20=50,s.checkFps30=1/30*1e3,s.checkFps45=1/45*1e3,s.checkFps60=1/60*1e3,t.GlobalJugger=s}(long||(long={})),function(t){class e{constructor(){this.animatinArr=new Array}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}UpdateFrame(t){for(var e=this.animatinArr,s=e.length-1;s>=0;s--){e[s].addFame(t)}}add(e){-1==this.animatinArr.indexOf(e)&&(0==this.animatinArr.length&&t.AnimationJugger.global.add(this),this.animatinArr.push(e))}remove(e){var s=this.animatinArr.indexOf(e);-1!=s&&(t.ArrayUtil.RemoveAt(this.animatinArr,s),e.GC(),0==this.animatinArr.length&&t.AnimationJugger.global.remove(this))}static delayFrame(s,i=null){var a=null;return s>0&&((a=t.ObjectPools.Inst.getObj(t.FrameVO.KEY,t.FrameVO)).delayFrame=s,a.handler=i,e.Inst.add(a)),null}}t.KeyFrameJugger=e}(long||(long={})),function(t){class e{constructor(){}}e.UI_MODEL=0,e.DEFAULT=1,e.SCENE=2,e.SOUND=3,e.PROLOADING=4,t.LoadLevel=e}(long||(long={})),function(t){class e{constructor(){this.currentActions=new Array,this._curByteLoad=0,this._byteLoaded=0,this.byteTotal=0,Laya.loader.retryNum=3,t.AssetCache.Init()}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}loadPageSub(e,s=null,i=!1,a=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var n=t.ObjectPools.Inst.getObj(t.SubLoadTask.KEY,t.SubLoadTask);return n.handlers.push(s),n.url=e,n.level=a,n.isRecover=i,this.addTask(n),!0}loadSound(e,s=null,i=t.LoadLevel.SOUND){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.SoundLoadTask.KEY,t.SoundLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadAtlas(e,s=null,i=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=new t.LayaAltasLoadTask;a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadTexture(e,s=null,i=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.TextureLoadTask.KEY,t.TextureLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadFguiIcon(e,s,i=t.UrlUtils.UI,a=null,n=!1,r=t.LoadLevel.DEFAULT){this.loadFguiPkg(e,i,Laya.Handler.create(this,(t,e,s,i)=>{i.loadResName(e,s)},[e,s,a]),n,r)}loadFguiPkg(e,s=t.UrlUtils.UI,i=null,a=!1,n=t.LoadLevel.DEFAULT){if(fgui.UIPackage.getByName(e)){let a=t.AssetCache.assetDic[s+e];i&&i.runWith(a)}else{var r=t.ObjectPools.Inst.getObj(t.GroupSheetLoadTask.KEY,t.GroupSheetLoadTask);r.handlers.push(i),r.pkgName=e,r.url=s+e,r.level=n,r.isRecover=a,this.addTask(r)}}loadUI(e,s=null,i=!0,a=t.UrlUtils.UI,n=t.LoadLevel.UI_MODEL){let r=a+e;if(this.checkCache(r,s))return!0;if(this.checkQueue(r,s))return!1;var l=t.ObjectPools.Inst.getObj(t.UILoadTask.KEY,t.UILoadTask);l.handlers.push(s),l.pkgName=e,l.url=r,l.isRecover=i,l.level=n,this.addTask(l)}loadSpine(e,s=null,i=!0,a=t.LoadLevel.UI_MODEL){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var n=t.ObjectPools.Inst.getObj(t.SpineLoadTask.KEY,t.SpineLoadTask);n.handlers.push(s),n.url=e,n.level=a,n.isRecover=i,this.addTask(n)}loadParticle(e,s=null,i=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.ParticleLoadTask.KEY,t.ParticleLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadSprite3D(e,s=null,i=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.Sprite3DLoadTask.KEY,t.Sprite3DLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadScene3D(e,s=null,i=t.LoadLevel.SCENE){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.Scene3DLoadTask.KEY,t.Scene3DLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadBin(e,s=null,i=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var a=t.ObjectPools.Inst.getObj(t.ByteLoadTask.KEY,t.ByteLoadTask);a.handlers.push(s),a.url=e,a.level=i,this.addTask(a)}loadAnimationClip(e,s=null,i=!0,a=t.LoadLevel.DEFAULT){if(this.checkCache(e,s))return!0;if(this.checkQueue(e,s))return!1;var n=t.ObjectPools.Inst.getObj(t.AnimationClipLoadTask.KEY,t.AnimationClipLoadTask);n.handlers.push(s),n.url=e,n.level=a,n.isRecover=i,this.addTask(n)}checkCache(e,s){var i=t.AssetCache.assetDic[e];return null!=i&&(this.byteTotal++,this.byteLoaded++,null!=s&&s.runWith(i),!0)}checkQueue(t,e){for(var s,i=this.currentActions.length,a=0;a<i;a++)if((s=this.currentActions[a]).url==t)return null!=e&&s.handlers.push(e),!0;return!1}addTask(e){this.byteTotal++,t.Logger.log(this,"加载数量：    "+this.byteTotal+e.url),0==this.currentActions.length&&Laya.timer.frameLoop(1,this,this.advanceTime),this.currentActions.push(e),e.run()}advanceTime(){if(this.isEmpty)Laya.timer.clear(this,this.advanceTime);else for(var e,s=this.currentActions.length,i=0;i<s;i++)(e=this.currentActions[i]).onUpdate(),e.state==t.LoadTask.STATE_COMPLETE&&(this.currentActions.splice(i,1),s--,i--,this.byteLoaded++,e.GC())}GetRate(){var t;this.curByteLoad=this.byteLoaded;for(var e=this.currentActions.length,s=0;s<e;s++)t=this.currentActions[s],this.curByteLoad+=t.rate;return 0==this.byteTotal?0:this.curByteLoad/this.byteTotal}get isEmpty(){return 0==this.currentActions.length}clearRate(){this.curByteLoad=0,this.byteLoaded=0,this.byteTotal=this.currentActions.length}set curByteLoad(t){this._curByteLoad=t}get curByteLoad(){return this._curByteLoad}set byteLoaded(t){this._byteLoaded=t}get byteLoaded(){return this._byteLoaded}}t.LoadQueue=e}(long||(long={})),function(t){class e{constructor(){}static Init(){Laya.timer.loop(e.LOOP_TIME,e,e.CheckCache)}static CheckCache(){let t=e.assetDic;var s=null;for(let e in t)(s=t[e]).IsCanGc()&&(s.Destroy(),delete t[e]);Laya.Resource.destroyUnusedResources()}static AddResource(t,s){e.assetDic[t]=s}static GetResource(t){return Laya.loader.getRes(t)}static LoadIcon(e,s,i=null){e&&s&&(s=decodeURIComponent(s),t.LoadQueue.Inst.loadTexture(s,Laya.Handler.create(null,(function(){e.url=s,null!=i&&i.run()}))))}}e.assetDic={},e.LOOP_TIME=3e4,t.AssetCache=e}(long||(long={})),function(t){class e{constructor(){this.gcTime=Number.MAX_VALUE,this.count=0,this.url=null,this.data=null,this.isRecover=!0}SetUrl(t){this.url=t}Decode(t){this.data=t,this.resetGcTime()}GetRes(){return this.count++,this.data}IsCanGc(){return this.isRecover&&this.count<=0&&Laya.timer.currTimer>=this.gcTime}resetGcTime(){this.gcTime=Laya.timer.currTimer+e.CACHE_TIME}Dispose(){this.count--,0==this.count?(this.resetGcTime(),t.Logger.warning(this,"资源达到回收条件：\t"+this.url)):this.count<0&&t.Logger.error(this,"资源有多余销毁次数：\t"+this.url)}Destroy(){e.DestroyByName(this.url),this.GC()}static DestroyByName(e){Laya.loader.clearRes(e),t.Logger.warning(this,"资源销毁成功：\t"+e)}GC(){}Reset(){this.gcTime=Number.MAX_VALUE,this.url=null,this.data=null,this.count=0,this.isRecover=!0}}e.CACHE_TIME=12e4,e.CACHE_OBJECT_TIME=12e4,e.CACHE_UI_TIME=6e4,t.Resource=e;class s extends e{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(s.KEY,this)}}s.KEY="AnimationClipResource",t.AnimationClipResource=s;class i extends e{constructor(){super()}Destroy(){this.GetRes().clear(),super.Destroy()}GC(){t.ObjectPools.Inst.gcObj(i.KEY,this)}}i.KEY="ByteResource",t.ByteResource=i;class a extends e{constructor(){super(),this.urls=null,this.sourceMap={}}setUrls(t){this.urls=t}setRes(t,e){this.sourceMap[t]=e}getRes(t){let e=fgui.UIPackage.getItemURL(this.pkgName,t),s=this.sourceMap[e];if(null==s){let i=fgui.UIPackage.getByName(this.pkgName),a=i&&i.getItemByName(t),n=a&&i._sprites[a.id],r=n&&n.atlas;r&&r.texture&&(r.load(),s=fgui.UIPackage.getItemAssetByURL(e),this.setRes(e,s))}return s}loadResName(e,s){let i=fgui.UIPackage.getItemURL(this.pkgName,e);this.getRes(i)?s&&s.runWith(i):t.PanelRegister.loadUrl(i,Laya.Handler.create(this,(t,e)=>{let s=fgui.UIPackage.getItemAssetByURL(e);this.setRes(e,s),t&&t.runWith(e)},[s]))}Reset(){super.Reset(),this.urls=null,this.pkgName="",this.sourceMap={}}GC(){t.ObjectPools.Inst.gcObj(a.KEY,this)}}a.KEY="GroupSheetResource",t.GroupSheetResource=a;class n extends e{constructor(){super()}GetRes(){let t=super.GetRes();return null==t?null:t.clone()}GC(){t.ObjectPools.Inst.gcObj(n.KEY,this)}}n.KEY="ParticleResource",t.ParticleResource=n}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}Destroy(){this.data.destroy(),super.Destroy()}}e.KEY="Scene3DResource",t.Scene3DResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="SoundResource",t.SoundResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}Decode(t){t.lock=!0,super.Decode(t)}Destroy(){this.data&&(this.data.lock=!1,this.data.destroy()),super.Destroy()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="SpineResource",t.SpineResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GetRes(){let t=super.GetRes();return null==t?null:t.clone()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="Sprite3DResource",t.Sprite3DResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="SubResource",t.SubResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="TextureResource",t.TextureResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="TxtResource",t.TxtResource=e}(long||(long={})),function(t){class e extends t.Resource{constructor(){super()}Destroy(){let t=this.url.lastIndexOf("/");if(-1!=t){let e=this.url.substring(t+1);fgui.UIPackage.getByName(e)&&fgui.UIPackage.removePackage(e)}super.Destroy()}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="UIResource",t.UIResource=e}(long||(long={})),function(t){class e{constructor(){this.handlers=new Array,this.level=0,this.state=e.STATE_DEFAULT,this.isRecover=!0,this.rate=0}run(){this.state=e.STATE_RUN}onComplete(s,i=!0){s?t.Logger.log(this,"加载完成：    "+this.url):t.Logger.log(this,"加载失败：    "+this.url),i&&null!=s&&s instanceof t.Resource&&(s.SetUrl(this.url),t.AssetCache.AddResource(this.url,s)),this.state=e.STATE_COMPLETE;for(var a,n=this.handlers.length,r=0;r<n;r++)(a=this.handlers[r])&&(null!=s?a.runWith(s):a.run());this.handlers.length=0,this.rate=1}onUpdate(){this.rate<.95&&(this.rate+=.01)}onLoadProgress(t){t>1&&(t=1),this.rate=t}GetSubName(){return null}GC(){}Reset(){this.handlers.length=0,this.url=null,this.level=0,this.state=e.STATE_DEFAULT,this.isRecover=!0,this.rate=0}}e.STATE_DEFAULT=0,e.STATE_RUN=1,e.STATE_COMPLETE=2,t.LoadTask=e;class s extends e{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.ANIMATIONCLIP,this.level)}onLoadComplete(e){let s=t.ObjectPools.Inst.getObj(t.AnimationClipResource.KEY,t.AnimationClipResource);this.isRecover||e&&(e.lock=!0),s.Decode(e),s.isRecover=this.isRecover,super.onComplete(s)}GC(){t.ObjectPools.Inst.gcObj(s.KEY,this)}}s.KEY="AnimationClipLoadTask",t.AnimationClipLoadTask=s;class i extends e{constructor(){super()}run(){super.run(),Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.BUFFER,this.level)}onLoadComplete(t){let e=new Laya.Byte(t);super.onComplete(e)}GC(){t.ObjectPools.Inst.gcObj(i.KEY,this)}}i.KEY="ByteLoadTask",t.ByteLoadTask=i;class a extends e{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){let e=this.url,s=e+"."+fgui.UIConfig.packageFileExtension;fgui.AssetProxy.inst.load(s,Laya.Handler.create(this,this.descCompleteHandler,[e]),null,Laya.Loader.BUFFER)}descCompleteHandler(t,e){let s=new fgui.UIPackage;s._resKey=t,s.loadPackage(new fgui.ByteBuffer(e),t);let i=s._items.length,a=[];for(var n=0;n<i;n++){var r=s._items[n];r.type==fgui.PackageItemType.Atlas?a.push({url:r.file,type:Laya.Loader.IMAGE}):r.type==fgui.PackageItemType.Sound&&a.push({url:r.file,type:Laya.Loader.SOUND})}s._customId=t,fgui.UIPackage._instById[s.id]=s,fgui.UIPackage._instByName[s.name]=s,this.onLoadComplete(a)}onLoadComplete(e){var s=new t.GroupSheetResource;s.pkgName=this.pkgName,s.setUrls(e),super.onComplete(s)}GC(){t.ObjectPools.Inst.gcObj(a.KEY,this)}}a.KEY="GroupSheetLoadTask",t.GroupSheetLoadTask=a;t.LayaAltasLoadTask=class extends e{constructor(){super()}run(){super.run(),Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.ATLAS,this.level)}onLoadComplete(t){super.onComplete(t)}}}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.HIERARCHY,this.level)}onLoadComplete(t){t=t&&t.clone(),super.onComplete(t)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="ParticleLoadTask",t.ParticleLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.HIERARCHY,this.level)}onLoadComplete(t){super.onComplete(t)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="Scene3DLoadTask",t.Scene3DLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.SOUND,this.level)}onLoadComplete(t){super.onComplete(t)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="SoundLoadTask",t.SoundLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run(),t.Logger.log(this,"开始加载：    "+this.url);let e=new Laya.Templet;e.loadAni(this.url),e.once(Laya.Event.COMPLETE,this,this.onLoadSpineTemplet,[e])}onLoadSpineTemplet(e){let s=t.ObjectPools.Inst.getObj(t.SpineResource.KEY,t.SpineResource);s.isRecover=this.isRecover,s.Decode(e),this.onComplete(s,!0)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="SpineLoadTask",t.SpineLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.HIERARCHY,this.level)}onLoadComplete(t){t=t&&t.clone(),super.onComplete(t)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="Sprite3DLoadTask",t.Sprite3DLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super(),this.count=0}run(){super.run();let t=this,e=null;Laya.Browser.onMiniGame?e=window.wx:Laya.Browser.onQQMiniGame?e=window.qq:Laya.Browser.onBDMiniGame?e=window.swan:(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame)&&(e=window.qg),null!=e?this.loadSub(e):t.onLoadComplete(!0)}loadSub(t){let e=this;console.log("加载分包: "+this.url);let s=t.loadSubpackage({name:e.url,success:function(t){console.log("加载分包成功！"),e.onLoadComplete(!0)},fail:function(s){console.log("加载分包失败！"),e.count++,e.count>3?e.onLoadComplete(!0):e.loadSub(t)},complete:function(){}});s&&null!=s.onProgressUpdate&&s.onProgressUpdate((function(t){e.onLoadProgress(t.progress)}))}onLoadComplete(e){let s=t.ObjectPools.Inst.getObj(t.SubResource.KEY,t.SubResource);s.isRecover=this.isRecover,s.Decode(e),super.onComplete(s),this.count=0}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}Reset(){super.Reset(),this.count=0}}e.KEY="SubLoadTask",t.SubLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super()}run(){super.run();let e=this.GetSubName();null!=e?t.LoadQueue.Inst.loadPageSub(e,Laya.Handler.create(this,this.StartLoad)):this.StartLoad(!0)}StartLoad(t){Laya.loader.load(this.url,Laya.Handler.create(this,this.onLoadComplete),Laya.Handler.create(this,this.onLoadProgress,null,!1),Laya.Loader.TEXTURE2D,this.level)}onLoadComplete(t){super.onComplete(t)}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="TextureLoadTask",t.TextureLoadTask=e}(long||(long={})),function(t){class e extends t.LoadTask{constructor(){super(),this.urls=null}run(){super.run(),this.StartLoad(null)}StartLoad(t){let e=this,s=this.url,i=s+"."+fgui.UIConfig.packageFileExtension;var a=Laya.Handler.create(this,(function(t){let i=new fgui.UIPackage;i._resKey=s,i.loadPackage(new fgui.ByteBuffer(t),s);let a=i._items.length;this.urls=[];for(var n=0;n<a;n++){var r=i._items[n];r.type==fgui.PackageItemType.Atlas?e.urls.push({url:r.file,type:Laya.Loader.IMAGE}):r.type==fgui.PackageItemType.Sound&&e.urls.push({url:r.file,type:Laya.Loader.SOUND})}e.urls.length>0?Laya.loader.create(e.urls,Laya.Handler.create(e,e.onLoadComplete,[e.url]),Laya.Handler.create(e,this.onLoadProgress,null,!1),null,null,e.level):e.onLoadComplete(e.url,!0)}));fgui.AssetProxy.inst.load(i,a,null,Laya.Loader.BUFFER)}onLoadComplete(e,s){if(e==this.url&&s){fgui.UIPackage.getByName(this.pkgName)||fgui.UIPackage.addPackage(this.url);let e=t.ObjectPools.Inst.getObj(t.UIResource.KEY,t.UIResource);e.isRecover=this.isRecover,e.Decode(s),super.onComplete(e)}}GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}}e.KEY="UILoadTask",t.UILoadTask=e}(long||(long={})),function(t){t.Dictionary=class extends Object{constructor(){super()}}}(long||(long={})),function(t){t.ObjectPool=class{constructor(t,e){this.gcTime=Number.MAX_VALUE,this.objs=null,this.cls=null,this.key=null,this.key=t,this.cls=e,this.objs=new Array}IsCanGc(){return this.objs.length>0&&Laya.timer.currTimer>=this.gcTime}Dispose(){this.objs.length=0,this.gcTime=Number.MAX_VALUE}getObj(...t){if(this.objs.length>0){return this.objs.pop()}return null!=this.cls?new this.cls(...t):null}gcObj(e){null!=e&&(t.Logger.isShowLog&&-1!=this.objs.indexOf(e)?t.Logger.warning(this,"重复回收对象"):(e.Reset(),this.objs.push(e),this.gcTime=Laya.timer.currTimer+t.Resource.CACHE_OBJECT_TIME))}}}(long||(long={})),function(t){class e{constructor(){this._classPool={},Laya.timer.loop(t.Resource.CACHE_OBJECT_TIME,this,this.CheckCache)}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}CheckCache(){let t=this._classPool,e=null;for(let s in t)e=t[s],e.IsCanGc()&&e.Dispose()}unRegistPoolForClass(e,s){if(null!=e){var i=this._classPool[e];return null!=i&&delete this._classPool[e],i}t.Logger.error(this,e+"key is null!")}getObj(t,e=null,...s){var i=this._classPool[t];return null==i&&(i=this.registPoolForClass(t,e)),i.getObj(...s)}registPoolForClass(e,s){if(null!=e){if(!(e in this._classPool)){var i=new t.ObjectPool(e,s);return this._classPool[e]=i,i}t.Logger.error(this,e+"key has register!")}else t.Logger.error(this,e+"key is null!")}gcObj(e,s){var i=this._classPool[e];null==i&&t.Logger.error(this,"unregister Class"),i.gcObj(s)}}e._Inst=null,t.ObjectPools=e}(long||(long={})),function(t){class e extends Laya.Material{constructor(){super(),this.setShaderName("ToonWaterShader")}get NoisTexture(){return this._shaderValues.getTexture(e.NOISTEXTURE)}set NoisTexture(t){this._shaderValues.setTexture(e.NOISTEXTURE,t)}get TilingOffset(){return this._shaderValues.getVector3(e.TILINGOFFSET)}set TilingOffset(t){this._shaderValues.setVector3(e.TILINGOFFSET,t)}get WaterColor_1(){return this._shaderValues.getVector3(e.WATERCOLOR_1)}set WaterColor_1(t){this._shaderValues.setVector3(e.WATERCOLOR_1,t)}get WaterColor_2(){return this._shaderValues.getVector3(e.WATERCOLOR_2)}set WaterColor_2(t){this._shaderValues.setVector3(e.WATERCOLOR_2,t)}get Water_time(){return this._shaderValues.getNumber(e.WATERTIME)}set Water_time(t){this._shaderValues.setNumber(e.WATERTIME,t)}static initShader(){var t={a_Position:Laya.VertexMesh.MESH_POSITION0,a_Normal:Laya.VertexMesh.MESH_NORMAL0,a_Texcoord:Laya.VertexMesh.MESH_TEXTURECOORDINATE0,a_Color:Laya.VertexMesh.MESH_COLOR0},e={u_MvpMatrix:Laya.Shader3D.PERIOD_SPRITE,u_WorldMat:Laya.Shader3D.PERIOD_SPRITE,u_CameraPos:Laya.Shader3D.PERIOD_CAMERA,u_Texture:Laya.Shader3D.PERIOD_MATERIAL,u_Time:Laya.Shader3D.PERIOD_SCENE,TilingOffset:Laya.Shader3D.PERIOD_MATERIAL,u_WaterColor_1:Laya.Shader3D.PERIOD_MATERIAL,u_WaterColor_2:Laya.Shader3D.PERIOD_MATERIAL,u_Water_time:Laya.Shader3D.PERIOD_MATERIAL},s=Laya.Shader3D.add("ToonWaterShader"),i=new Laya.SubShader(t,e);s.addSubShader(i);var a=i.addShaderPass('\n            \n            #include "Lighting.glsl";\n            attribute vec4 a_Position;\n            attribute vec2 a_Texcoord;\n            attribute vec3 a_Normal;\n            attribute vec4 a_Color;\n            uniform mat4 u_MvpMatrix;\n            uniform vec3 u_CameraPos;\n            uniform mat4 u_WorldMat;\n            //uniform float u_Time;\n            varying vec2 v_Texcoord;\n            varying vec3 v_Normal;\n            varying vec3 v_ViewDir;\n            \n            \n            varying vec4 v_Color;\n            varying vec3 v_PositionWorld;\n           \n            void main()\n            {\n                \n                    gl_Position=u_MvpMatrix * a_Position;\n                    mat3 worldMat=mat3(u_WorldMat);\n                    v_Normal=worldMat*a_Normal;\n              \n                    v_Texcoord=a_Texcoord;\n                \n                    v_Color = a_Color;\n                    v_PositionWorld=(u_WorldMat*a_Position).xyz;            \n              \n               \n                v_ViewDir = u_CameraPos- v_PositionWorld;    //相机视角\n    \n                gl_Position=remapGLPositionZ(gl_Position); \n            }','\n            #ifdef FSHIGHPRECISION\n                precision highp float;\n            #else\n                precision mediump float;\n            #endif\n            #include "Lighting.glsl";\n                varying vec2 v_Texcoord;\n                varying vec3  v_Normal;\n                varying vec3 v_ViewDir;\n                varying mat3 ModelViewMatrix;\n                varying vec4 v_Color;\n                uniform sampler2D u_Texture;\n                uniform float u_Time;\n                uniform vec3 TilingOffset;\n                uniform vec3 u_WaterColor_1;  \n                uniform vec3 u_WaterColor_2; \n                uniform float u_Water_time;\n            void main()\n            {    \n                // float T = fract(u_Time*0.1);\n                float T = u_Water_time;\n                vec3 ViewDir = normalize(v_ViewDir);\n                vec3 normal = normalize(v_Normal);\n                float F0  = clamp(dot(ViewDir,normal),0.0,1.0);\n                vec3 Speed = vec3(-1.0,2.0,0.0);\n               vec3 WaterColor =   v_Color.rgb;\n               vec3 WaterNois0 =  texture2D(u_Texture,v_Texcoord*TilingOffset.xy+(Speed.xy*T*-1.0)).rgb;\n               vec3 WaterNois1 =  texture2D(u_Texture,v_Texcoord*TilingOffset.xy+(WaterNois0.x*0.3)).rgb;\n               vec3 F1WaterColor =  WaterColor+smoothstep(0.98,1.0,v_Color.a*(WaterNois0.x+1.0))*u_WaterColor_1;\n               vec3 F2WaterColor =  smoothstep(TilingOffset.z,0.5,(WaterNois1.z*1.3)*WaterNois0.x)*u_WaterColor_2+F1WaterColor;\n              \n                 gl_FragColor =  vec4(F2WaterColor,0.75);\n            }');a.renderState.cull=Laya.RenderState.CULL_BACK,a.renderState.blend=Laya.RenderState.BLEND_ENABLE_ALL,a.renderState.srcBlend=Laya.RenderState.BLENDPARAM_SRC_ALPHA,a.renderState.dstBlend=Laya.RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA,a.renderState.depthWrite=!1,a.renderState.depthTest=Laya.RenderState.DEPTHTEST_LEQUAL}}e.NOISTEXTURE=Laya.Shader3D.propertyNameToID("u_Texture"),e.TILINGOFFSET=Laya.Shader3D.propertyNameToID("TilingOffset"),e.WATERCOLOR_1=Laya.Shader3D.propertyNameToID("u_WaterColor_1"),e.WATERCOLOR_2=Laya.Shader3D.propertyNameToID("u_WaterColor_2"),e.WATERTIME=Laya.Shader3D.propertyNameToID("u_Water_time"),t.ToonWaterMaterial=e}(long||(long={})),function(t){class e{constructor(){this._isMusicPlay=!0,this._isSoundPlay=!0,this._bgUrl=null,Laya.SoundManager.autoReleaseSound=!1,this.replay()}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}play(e,s=!0,i=1,a=null){let n=t.UrlUtils.GetMusic(e);s?(t.Logger.debug(this,"=====>播放音效 sound: "+n),this.playSound(n,i,a)):this.playMusic(n,i,a)}playSound(t,e=1,s=null,i=null,a=0){t&&this._isSoundPlay&&Laya.SoundManager.playSound(t,e,s,i,a)}playMusic(t,e=0,s=null,i=0){this._bgUrl!=t&&this.playBackMusic(t,e,s,i)}playBackMusic(e,s=0,i=null,a=0){this._bgUrl=e,this._isMusicPlay&&t.LoadQueue.Inst.loadSound(e,Laya.Handler.create(null,(function(t){Laya.SoundManager.stopMusic(),Laya.timer.once(100,this,()=>{Laya.SoundManager.playMusic(e,s,i,a)})})))}set isMusicPlay(t){this._isMusicPlay=t,t?null!=this._bgUrl&&this.playBackMusic(this._bgUrl):(Laya.SoundManager.stopMusic(),null!=this.innerAudioContext&&this.innerAudioContext.stop())}get isMusicPlay(){return this._isMusicPlay}set isSoundPlay(t){this._isSoundPlay=t}get isSoundPlay(){return this._isSoundPlay}get bgUrl(){return this._bgUrl}stop(){this.isMusicPlay=!1,this.isSoundPlay=!1}replay(){this.isMusicPlay=t.LocalCache.Inst.GetMusic(),this.isSoundPlay=t.LocalCache.Inst.GetSound()}}e.back="back",e.merge="merge",e.click="click",e._Inst=null,t.SoundMgr=e}(long||(long={})),function(t){class e{constructor(){this.root=null,this.last=null}static create(){return this.pool.pop()||new e}static recover(t){t&&(t.clear(),-1==this.pool.indexOf(t)&&this.pool.push(t))}addNode(t){if(null==this.root)this.root=this.last=t,this.root.parentNode=this.last.parentNode=null;else{let e=this.last;this.last.nextNode=t,this.last=t,this.last.parentNode=e,this.last.nextNode=null}}removeNode(t,e=!1){if(!t)return null;if(t==this.root)return this.clear(),t;let s=null,i=this.root;for(;null!==i;){if(i===t){if(null==s)null==t.nextNode&&(this.root.parentNode=null,this.root.nextNode=null),this.root=t.nextNode,this.root&&(this.root.parentNode=null);else if(null!=t.nextNode){if(e)return s.nextNode=null,t.parentNode=null,this.clearNode(t),this.last=s,s=null,t;s.nextNode=t.nextNode,s.nextNode.parentNode=s}return t===this.last&&(this.last=s),t.ResetNode(),t}s=i,i=i.nextNode}return null}hasNode(t){let e=this.root;for(;null!=e;){if(e==t)return!0;e=e.nextNode}return!1}clearNode(t){let e,s=t;for(;s&&null!=s.nextNode;)s=s.nextNode;for(let t=s;t;t=t.parentNode)t.nextNode=null,e&&(e.parentNode=null),e=t;t&&t.ResetNode()}reverse(){let t=[];for(let e=this.root;e;e=e.nextNode)t.push(e);for(this.clear();t.length>0;)this.addNode(t.pop());return this}clear(){let t;for(let e=this.last;e;e=e.parentNode)e.nextNode=null,t&&(t.parentNode=null),t=e;t&&t.ResetNode(),this.root=null,this.last=null}recover(){e.recover(this)}}e.pool=[],t.LinkList=e}(long||(long={})),function(t){t.LinkNode=class{constructor(){this.parentNode=null,this.nextNode=null}ResetNode(){this.parentNode=null,this.nextNode=null}}}(long||(long={})),function(t){class e{static Remove(t,e){t[e]=t[t.length-1],t.pop()}static randomArray(t,e=6){var s=t&&t.slice();if(null!=s){for(var i,a,n=s.length,r=0;r<n;r++)a=s[r],i=Math.floor(Math.random()*n),s[r]=s[i],s[i]=a;s=s.slice(0,e)}return s}static RemoveAt(t,e){let s=t.pop();e<t.length&&(t[e]=s)}static shuffle(t){let e=t.length;if(e>1)for(;e;){let s=Math.floor(Math.random()*e--);[t[s],t[e]]=[t[e],t[s]]}return t}static sortOn(t,s){return t.sort((function(t,i){let a=[t,i];return a=a.concat(s),e.sortByProps.apply(null,a)}))}static sortByProps(t,s,...i){let a=[];for(let t=2;t<arguments.length;t++)a[t-2]=arguments[t];let n=[],r=!0;if(a.length<1)for(let e in t){if(t[e]>s[e]){n.push(1);break}if(t[e]!==s[e]){n.push(-1);break}n.push(0)}else for(let i=0;i<a.length;i++){let l=a[i];for(let i in l){if(r=l[i]===e.NUMERIC,t[i]>s[i]){n.push(r?1:-1);break}if(t[i]!==s[i]){n.push(r?-1:1);break}n.push(0)}}for(let t=0;t<n.length;t++)if(1===n[t]||-1===n[t])return n[t];return 0}static getPages(t,e=5){return(t&&t.length>0?t.length%e>0?parseInt(""+t.length/e)+1:parseInt(""+t.length/e):0)||1}static getPageList(t,e=1,s=5){var i=new Array,a=0;if(!(t.length>0))return a=0,i;if(e>(a=t.length%s>0?parseInt(""+t.length/s)+1:parseInt(""+t.length/s)))return null;var n=(e-1)*s,r=e*s;r=0==parseInt(""+t.length%s)?e*s:e==a?(e-1)*s+parseInt(""+t.length%s):e*s;for(var l=n;l<r;l++)i.push(t[l]);return i}static printArray(s,i,a){t.Logger.debug(this,"================打印二维数据================start");let n=null;for(let r=1;r<=i;r++)n=e.getPageList(s,r,a),t.Logger.debug(this,r-1+": "+n.join(","));t.Logger.debug(this,"================打印二维数据================end")}}e.DESCENDING="desc",e.NUMERIC="asc",t.ArrayUtil=e}(long||(long={})),function(t){class e{constructor(t=1,e=1,s=1,i=1){this.r=t,this.g=e,this.b=s,this.a=i}static gammaToLinearSpace(t){return t<=.04045?t/12.92:t<1?Math.pow((t+.055)/1.055,2.4):Math.pow(t,2.4)}static linearToGammaSpace(t){return t<=0?0:t<=.0031308?12.92*t:t<=1?1.055*Math.pow(t,.41666)-.055:Math.pow(t,.41666)}toLinear(t){t.r=e.gammaToLinearSpace(this.r),t.g=e.gammaToLinearSpace(this.g),t.b=e.gammaToLinearSpace(this.b)}toGamma(t){t.r=e.linearToGammaSpace(this.r),t.g=e.linearToGammaSpace(this.g),t.b=e.linearToGammaSpace(this.b)}cloneTo(t){var e=t;e.r=this.r,e.g=this.g,e.b=this.b,e.a=this.a}clone(){var t=new e;return this.cloneTo(t),t}forNativeElement(){}}e.RED=new e(1,0,0,1),e.GREEN=new e(0,1,0,1),e.BLUE=new e(0,0,1,1),e.CYAN=new e(0,1,1,1),e.YELLOW=new e(1,.92,.016,1),e.MAGENTA=new e(1,0,1,1),e.GRAY=new e(.5,.5,.5,1),e.WHITE=new e(1,1,1,1),e.BLACK=new e(0,0,0,1),t.Color=e}(long||(long={})),function(t){t.ColorUtil=class{static toHexColor(t){return Laya.Utils.toHexColor(t)}static toRGBA(t,e=1){let s=this.HexToColor(t);return this.MakeStyleString(s.r,s.g,s.b,e)}static MakeStyleString(t,e,s,i=1){return t*=255,e*=255,s*=255,i<1?`rgba(${t},${e},${s},${i})`:`rgb(${t},${e},${s})`}static RgbToHex(t,e,s){for(var i=(t<<16|e<<8|s).toString(16);i.length<6;)i="0"+i;return"#"+i}static ColorToHex(t){return this.RgbToHex(255*t.r,255*t.g,255*t.b)}static HexToColor(e,s=1){e.startsWith("#")&&(e=e.substring(1));let i=e.substring(0,2),a=e.substring(2,4),n=e.substring(4,6),r=e.substring(6,8),l=parseInt(i,16),o=parseInt(a,16),h=parseInt(n,16),c=s||parseInt(r,16);return new t.Color(l/255,o/255,h/255,c)}static ToV3(t){return new Laya.Vector3(t.r,t.g,t.b)}static ToV4(t){return new Laya.Vector4(t.r,t.g,t.b,t.a)}static HexToV3(t){t.startsWith("#")&&(t=t.substring(1));let e=t.substring(0,2),s=t.substring(2,4),i=t.substring(4,6),a=parseInt(e,16),n=parseInt(s,16),r=parseInt(i,16);return new Laya.Vector3(a/255,n/255,r/255)}static HexToV4(t,e=null){t.startsWith("#")&&(t=t.substring(1));let s=t.substring(0,2),i=t.substring(2,4),a=t.substring(4,6),n=t.substring(6,8),r=parseInt(s,16),l=parseInt(i,16),o=parseInt(a,16),h=e||parseInt(n,16);return new Laya.Vector4(r/255,l/255,o/255,h)}}}(long||(long={})),function(t){t.CurveUtil=class{static CreateCurvePath(t,e,s,i){let a=[];if(i<2)return a;let n=1/(i-1);for(let r=0;r<i;r++)a.push(this.BesselCurve(t,e,s,n*r));return a}static BesselCurve(t,e,s,i){return i<0?i=0:i>1&&(i=1),new Laya.Point(Math.pow(1-i,2)*t.x+2*i*(1-i)*e.x+Math.pow(i,2)*s.x,Math.pow(1-i,2)*t.y+2*i*(1-i)*e.y+Math.pow(i,2)*s.y)}}}(long||(long={})),function(t){class e{constructor(){}static getRequest(t=location.search){if(null==e._rquest){var s=this.getRequestParams(t);e._rquest=s}return e._rquest}static getRequestParams(t){if(!t)return{};var e=new Object,s=t.indexOf("?");if(-1!=s)for(var i=t.substring(s+1).split("&"),a=0;a<i.length;a++){var n=i[a].split("=");e[n[0]]=n[1]}return e}static getHref(t=window.location.href){let e=t.lastIndexOf("?");if(-1!=e&&(t=t.substring(0,e)),e=t.lastIndexOf(".html"),-1!=e)e=t.lastIndexOf("/"),t=t.substring(0,e);else{"/"==t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1))}return t}static openHttpUrl(t,e="_self"){window.open(t,e)}}t.JSUtil=e}(long||(long={})),function(t){t.LTDictionary=class{constructor(){this.items={}}set(t,e){this.items[t]=e}has(t){return this.items.hasOwnProperty(t)}remove(t){return!!this.has(t)&&(delete this.items[t],!0)}get(t){return this.has(t)?this.items[t]:void 0}keys(){return Object.keys(this.items)}get length(){return this.keys().length}clear(){this.items={}}}}(long||(long={})),function(t){class e{static calculateLinePoint(t,e,s,i=null){return Laya.Vector3.normalize(e,e),null==i&&(i=new Laya.Vector3),i.setValue(t.x+e.x*s,t.y+e.y*s,t.z+e.z*s),i}static GetForward(t){let e=new Laya.Vector3;return t.getForward(e),Laya.Vector3.scale(e,-1,e),e}static localToGlobal(t,e){if(t.parent==e)return;let s=t.transform.position.clone(),i=t.transform.rotationEuler.clone();e.addChild(t),t.transform.position=s,t.transform.rotationEuler=i}static globalToLocal(t,s){let i=t.transform.localPosition.clone(),a=t.transform.localRotationEuler.clone();s.addChild(t),t.transform.localPosition=e.InverseTransformPoint(s.transform,i),t.transform.localRotationEuler=a}static translate(t,e){let s=new Laya.Vector3;return Laya.Matrix4x4.createFromQuaternion(t.rotation,Laya.Transform3D._tempMatrix0),Laya.Vector3.transformCoordinate(e,Laya.Transform3D._tempMatrix0,Laya.Transform3D._tempVector30),Laya.Vector3.add(t.position,Laya.Transform3D._tempVector30,s),s}static InverseTransformPoint(t,e){let s=new Laya.Matrix4x4;t.worldMatrix.invert(s);let i=new Laya.Vector3;return Laya.Vector3.transformCoordinate(e,s,i),i}static GetPointFrom3DWorld(t,e,s=null){let i=new Laya.Vector4;return t&&t.viewport.project(e,t.projectionViewMatrix,i),i.x=Math.ceil(i.x),i.y=Math.ceil(i.y),null!=s?s.globalToLocal(i.x,i.y):new Laya.Point(i.x,i.y)}static GetScalePos(t,e,s){let i=new Laya.Vector3;return Laya.Vector3.subtract(e,t,i),Laya.Vector3.scale(i,s,i),new Laya.Vector3(t.x+i.x,t.y+i.y,t.z+i.z)}static distance(t,e,s,i){let a=t-s,n=e-i;return Math.sqrt(a*a+n*n)}static distanceNS(t,e,s,i){let a=s-t,n=i-e;return a*a+n*n}static random(t,s=e.max){if(0==t)return!1;return Math.random()*s<=t}static makeRandom(t,e){let s=t+Math.random()*(e-t);return s<e?Math.floor(s):e}static angleToRadian(t){return t*Math.PI/180}static radianToAngle(t){return 180*t/Math.PI}static GetMeshSprite3D(t){if(null==t)return null;if(t instanceof Laya.MeshSprite3D)return t;let s=t.numChildren;for(let i=0;i<s;i++){const s=t.getChildAt(i);let a=e.GetMeshSprite3D(s);if(null!=a)return a}return null}static GetMaterial(t){if(null==t)return null;if(t instanceof Laya.MeshSprite3D)return t.meshRenderer.sharedMaterial;let s=t.numChildren;for(let i=0;i<s;i++){const s=t.getChildAt(i);let a=e.GetMaterial(s);if(null!=a)return a}return null}static FindSprite3DByName(t,s){if(null==t)return null;if(t.name==s)return t;let i=t.numChildren;for(let a=0;a<i;a++){const i=t.getChildAt(a);let n=e.FindSprite3DByName(i,s);if(null!=n)return n}return null}static FindPhysicsCollider(t){if(null==t)return null;let s=t.getComponent(Laya.PhysicsCollider);if(null!=s)return s;let i=t.numChildren;for(let s=0;s<i;s++){const i=t.getChildAt(s);let a=e.FindPhysicsCollider(i);if(null!=a)return a}return null}static MultiPointBezier(t,e,s){s.setTo(0,0);for(var i=t.length,erxiangshi=function(t,e){for(var s=1,i=1;e>0;)s*=t,i*=e,t--,e--;return s/i},a=0;a<i;a++){var n=t[a];s.x+=n.x*Math.pow(1-e,i-1-a)*Math.pow(e,a)*erxiangshi(i-1,a),s.y+=n.y*Math.pow(1-e,i-1-a)*Math.pow(e,a)*erxiangshi(i-1,a)}return s}static angle(t,e){let s=new Laya.Vector3;Laya.Vector3.normalize(t,s);let i=new Laya.Vector3;return Laya.Vector3.normalize(e,i),Math.acos(Laya.Vector3.dot(s,i))*(180/Math.PI)}static changeToM180To180(t){let s=e.clampAngle(t.x,-180),i=e.clampAngle(t.y,-180),a=e.clampAngle(t.z,-180);return new Laya.Vector3(s,i,a)}static ClampRotationEulerRange(t,s){return t.x=e.clampAngle(t.x,s.x-180),t.x=e.MinNearAngle(t.x,s.x),t.y=e.clampAngle(t.y,s.y-180),t.y=e.MinNearAngle(t.y,s.y),t.z=e.clampAngle(t.z,s.z-180),t.z=e.MinNearAngle(t.z,s.z),t}static clampAngle(t,s){return t<s?(t+=360,t=e.clampAngle(t,s)):t>s+360&&(t-=360,t=e.clampAngle(t,s)),t}static MinNearAngle(t,e){return e>t?e-t<t+360-e?t:t+360:t-e<e-(t-360)?t:t-360}static GetBezierPoint(t,e,s){s.setTo(0,0);var getPoint=function(t,e,s){let i=t.x+(e.x-t.x)*s,a=t.y+(e.y-t.y)*s;return new Laya.Point(i,a)};let i=[];for(let e=0;e<t.length;e++)i.push(t[e]);for(;i.length>1;){let t=[];for(let s=0;s<i.length-1;s++)t.push(getPoint(i[s],i[s+1],e));i=t}return s.x=i[0].x,s.y=i[0].y,s}static GetRandomItemByWeight(t,s=1){if(null==t||t.length<=0)return null;let i=0;for(let e=0;e<t.length;e++){let s=t[e];null==s.weight&&(s.weight=1),i+=s.weight}let a=t.slice();a=a.sort((t,e)=>t.weight<e.weight?-1:t.weight>e.weight?1:0);let n=[];for(let t=0;t<s;t++){let t=e.GetRandomItem2(a,i);i-=t.weight,n.push(t)}return n}static GetRandomItem(t,s=1e4){if(null==t||t.length<=0)return null;let i=t.slice();i=i.sort((t,e)=>t.weight<e.weight?-1:t.weight>e.weight?1:0);let a=e.makeRandom(0,s),n=i.length,r=0,l=null;for(let t=0;t<n;t++){let e=i[t];if(r+=e.weight,a<r){l=e,i.splice(t,1);break}}return l}static GetRandomItem2(t,s=1e4){if(null==t||t.length<=0)return null;let i=e.makeRandom(0,s),a=t.length,n=0,r=null;for(let e=0;e<a;e++){let s=t[e];if(n+=s.weight,i<n){r=s,t.splice(e,1);break}}return r}static rotateAroundAxis(t,e,s){let i=new Laya.Vector3,a=new Laya.Vector3,n=Laya.Vector3.dot(e,t);a.x=n*e.x,a.y=n*e.y,a.z=n*e.z,Laya.Vector3.subtract(t,a,i),i.x=Math.cos(s)*i.x,i.y=Math.cos(s)*i.y,i.z=Math.cos(s)*i.z;let r=new Laya.Vector3;return Laya.Vector3.cross(e,t,r),r.x=Math.sin(s)*r.x,r.y=Math.sin(s)*r.y,r.z=Math.sin(s)*r.z,Laya.Vector3.add(i,r,i),Laya.Vector3.add(i,a,i),i}static WorldToScreen2(t,e){var s=this.InverseTransformPoint2(t.transform,e).z,i=new Laya.Vector3;return t.viewport.project(e,t.projectionViewMatrix,i),new Laya.Vector3(i.x/Laya.stage.clientScaleX,i.y/Laya.stage.clientScaleY,s)}static ScreenToWorld(t,e){var s=.5*t.fieldOfView*Math.PI/180;let i=e.z*Math.tan(s),a=i*t.aspectRatio,n=this.GetLowerLeft(t.transform,e.z,a,i),r=this.GetScreenScale(a,i);var l=new Laya.Vector3,o=this.InverseTransformPoint2(t.transform,n);return l=new Laya.Vector3(-e.x/r.x,e.y/r.y,0),Laya.Vector3.add(o,l,l),l=this.TransformPoint(t.transform,l)}static GetScreenScale(t,e){var s=new Laya.Vector3;return s.x=Laya.stage.width/t/2,s.y=Laya.stage.height/e/2,s}static GetLowerLeft(t,e,s,i){var a=new Laya.Vector3,n=new Laya.Vector3;t.getRight(n),Laya.Vector3.normalize(n,n);var r=new Laya.Vector3(n.x*s,n.y*s,n.z*s);Laya.Vector3.add(t.position,r,a);var l=new Laya.Vector3;t.getUp(l),Laya.Vector3.normalize(l,l);var o=new Laya.Vector3(l.x*i,l.y*i,l.z*i);Laya.Vector3.subtract(a,o,a);var h=new Laya.Vector3;t.getForward(h),Laya.Vector3.normalize(h,h);var c=new Laya.Vector3(h.x*e,h.y*e,h.z*e);return Laya.Vector3.subtract(a,c,a),a}static InverseTransformPoint2(t,e){var s=new Laya.Vector3;t.getRight(s);var i=new Laya.Vector3;t.getUp(i);var a=new Laya.Vector3;t.getForward(a);var n=new Laya.Vector3(-a.x,-a.y,-a.z),r=this.ProjectDistance(e,t.position,s),l=this.ProjectDistance(e,t.position,i),o=this.ProjectDistance(e,t.position,n);return new Laya.Vector3(r,l,o)}static TransformPoint(t,e){var s=new Laya.Vector3;return Laya.Vector3.transformQuat(e,t.rotation,s),Laya.Vector3.add(s,t.position,s),s}static ProjectDistance(t,e,s){var i=new Laya.Vector3;Laya.Vector3.subtract(t,e,i);var a=this.Angle2(i,s)*Math.PI/180,n=Laya.Vector3.distance(t,e);return n*=Math.cos(a)}static Angle2(t,e){var s=(t.x*e.x+t.y*e.y+t.z*e.z)/(Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)*Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z));return s<-1&&(s=-1),s>1&&(s=1),180*Math.acos(s)/Math.PI}static GetPosByStr(t){return new Laya.Vector3(-parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))}static GetRotByStr(t){return new Laya.Vector3(-parseFloat(t[0]),180-parseFloat(t[1]),parseFloat(t[2]))}static GetColorByStr(t){return new Laya.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))}static replaceAll(t,s,i){return-1!=(t=t.replace(s,i)).indexOf(s)&&(t=e.replaceAll(t,s,i)),t}}e.max=1e4,t.MathUtil=e}(long||(long={})),function(t){class e{constructor(){}static addChildTo(t,e){let s=t.localToGlobal(),i=e.globalToLocal(s.x,s.y);t.removeFromParent(),e.addChild(t),t.setXY(i.x,i.y)}static findChild(t,e,...s){return null==t?null:t.name==e?t:this._findChild(t._children,e,s)}static _findChild(t,e,s){for(var i=[],a=0;a<t.length;a++){var n=t[a];if(n.active){if(n.name==e||-1!=s.indexOf(n.name))return n;n.numChildren&&(i=i.concat(n._children))}}return i.length?this._findChild(i,e,s):null}static getParentOf(t,e=null){let s=e?e.parent:null;return null!=s?s instanceof t?s:this.getParentOf(t,s):null}static globalIsIn(t,e=null){if(null==e&&(e=new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),null==t||null==t.parent)return!1;let s=t.parent.localToGlobal(t.x,t.y);if(t.pivotAsAnchor){let i=.5*t.width,a=.5*t.height;if(e.x>=s.x-i&&e.x<=s.x+i&&e.y>=s.y-a&&e.y<=s.y+a)return!0}else if(e.x>=s.x&&e.x<=s.x+t.width&&e.y>=s.y&&e.y<=s.y+t.height)return!0;return!1}static globalIsInRange(t=null,e=null,s=null){if(t=t||new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY),s&&null==e){let t=s.localToGlobal(0,0);if(e=e||this.range,s.pivotAsAnchor){let i=.5*s.width,a=.5*s.height;e.x=t.x-i,e.y=t.y-a,e.width=s.width,e.height=s.height}else e.x=t.x,e.y=t.y,e.width=s.width,e.height=s.height}return e&&e.contains(t.x,t.y)}static getScreenTexture(){try{return Laya.stage.drawToTexture(Laya.stage.width,Laya.stage.height,0,0)}catch(t){}return null}}e.range=new Laya.Rectangle,t.ObjectUtils=e}(long||(long={})),function(t){class e{static getSkeleton(){let e=this.pool.pop();return null==e&&(e=new t.SkeletonAnimation),e.visible=!0,e}static recover(t){t&&-1==this.pool.indexOf(t)&&(t.clear(),t.removeFromParent(),this.pool.push(t))}}e.pool=[],t.SkeletonUtils=e}(long||(long={})),function(t){t.StringUtil=class{static replaceEndStr(t,e=-1,s=""){let i="";return i=t&&t.length>e?t.slice(0,e-1)+s:t,i}static formatToTime(t,e="00:00:00"){let s=(t=Number(t.toFixed(0)))%60,i=(t-s)/60%60,a=(t-60*i-s)/3600,n=s<10?"0"+s.toString():s.toString(),r=i<10?"0"+i.toString():i.toString(),l=a<10?"0"+a.toString():a.toString();if("hms"==e)return l+"h "+r+"m "+n+"s";if("00:00"==e)return r+":"+n;if("hms2"==e){let t=Math.floor(a/24);return a=Math.ceil(a%24),(t>0?t+"天":"")+(a>0?a+"小时":"")+(i>0?i+"分钟":"")+(s>0?s+"秒":"")}if("天00:00:00"==e){let t=Math.floor(a/24);return a=Math.ceil(a%24),t+"天"+(a<10?"0"+a.toString():a.toString())+":"+r+":"+n}return l+":"+r+":"+n}}}(long||(long={})),function(t){class e{static toInt(t,e=1){return t-t%e}static getLocalTime(){return(new Date).getTime()}static formatToHMS(t,s=":"){var i=((t=e.toInt(t))-t%3600)/3600%24,a=(t%3600-t%60)/60,n=t%60,r="";return i<10&&(r+="0"),r+=i,r+=s,a<10&&(r+="0"),r+=a,r+=s,n<10&&(r+="0"),r+=n}static formatToMS(t,e=":"){var s=(t-t%3600)/3600%24,i=(t%3600-t%60)/60,a=Math.floor(t%60),n="";return s>0&&(i+=60*s),i<10&&(n+="0"),n+=i,n+=e,a<10&&(n+="0"),n+=a}static judgeInTime(t,e="all"){let s=t.split("~"),i=s[0],a=s[1];s=-1!=i.indexOf(":")?i.split(":"):i.split(".");let n=parseInt(s[0]),r=parseInt(s[1]),l=parseInt(s[2]),o=parseInt(s[3])||0,h=parseInt(s[4])||0,c=parseInt(s[5])||0;s=-1!=a.indexOf(":")?a.split(":"):a.split(".");let u=parseInt(s[0]),d=parseInt(s[1]),g=parseInt(s[2]),m=parseInt(s[3])||23,p=parseInt(s[4])||59,f=parseInt(s[5])||59,L=new Date,y=L.getTime(),_=L.getFullYear(),v=L.getMonth()+1,T=L.getDay(),C=L.getHours(),w=L.getMinutes(),I=L.getSeconds();L.setFullYear(n,r-1,l),L.setHours(o,h,c);let S=L.getTime();L.setFullYear(u,d-1,g),L.setHours(m,p,f);let E=L.getTime();if("all"==e)return y>=S&&y<=E;if("hms"==e){let t=60*m+60*p+f,e=60*C+60*w+I;return e>=60*o+60*h+c&&e<=t}return"ymd"==e&&(_>=n&&_<=u&&v>=r&&v<=d&&T>=l&&T<=g)}}t.TimeUtil=e}(long||(long={})),function(t){class e{static start(){Laya.stage.addChild(fgui.GRoot.inst.displayObject),e.fightLayer=new fgui.GComponent,e.mainDownLayer=new fgui.GComponent,e.mainLayer=new fgui.GComponent,e.windowLayer=new fgui.GComponent,e.alertLayer=new fgui.GComponent,e.topLayer=new fgui.GComponent,e.adLayer=new fgui.GComponent,e.fightLayer.name="fightLayer",e.mainDownLayer.name="mainDownLayer",e.mainLayer.name="mainLayer",e.windowLayer.name="windowLayer",e.alertLayer.name="alertLayer",e.topLayer.name="topLayer",fgui.GRoot.inst.addChild(e.fightLayer),fgui.GRoot.inst.addChild(e.mainDownLayer),fgui.GRoot.inst.addChild(e.mainLayer),fgui.GRoot.inst.addChild(e.windowLayer),fgui.GRoot.inst.addChild(e.alertLayer),fgui.GRoot.inst.addChild(e.adLayer),fgui.GRoot.inst.addChild(e.topLayer),e.topLayer.touchable=!1,fgui.GRoot.inst.name="GRoot",fgui.UIConfig.defaultFont=t.GlobalConfig.Font_Normal,fgui.UIConfig.packageFileExtension="lm",Laya.stage.on(Laya.Event.RESIZE,e,e.onResize),this.onResize(),t.GlobalConfig.stat&&fgui.GRoot.inst.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown)}static onMouseDown(t){this.checkNode(fgui.GRoot.inst,t.target,"")}static checkNode(s,i,a){let n=s.numChildren;for(let r=0;r<n;r++){const n=s.getChildAt(r);if(n.displayObject==i)return a+=n.name,void t.Logger.debug(this,"=====>"+a);(n instanceof fgui.GComponent||n instanceof fgui.GMovieClip)&&e.checkNode(n,i,a+n.name+"|")}}static onResize(){fgui.GRoot.inst.setSize(Laya.stage.width,Laya.stage.height),t.GlobalConfig.viewWidth=fgui.GRoot.inst.viewWidth,t.GlobalConfig.viewHeight=fgui.GRoot.inst.viewHeight,e.onUpdate(e.fightLayer),e.onUpdate(e.mainDownLayer),e.onUpdate(e.mainLayer),e.onUpdate(e.windowLayer),e.onUpdate(e.alertLayer),e.onUpdate(e.adLayer),e.onUpdate(e.topLayer)}static onUpdate(t){let e=t.numChildren;for(var s=null,i=0;i<e;i++)null!=(s=t.getChildAt(i))&&s.isLoaded&&s.onResize()}}t.GameLayer=e}(long||(long={})),function(t){class e{static SetWindowLayout(t){switch(t.GetViewStruct().layout){case e.LAYOUT_LEFT_TOP:t.x=0,t.y=0,t.setSize(Laya.stage.width,Laya.stage.height);break;case e.LAYOUT_CENTER_TOP:t.x=.5*(Laya.stage.width-t.viewWidth),t.y=0;break;case e.LAYOUT_RIGHT_TOP:t.x=Laya.stage.width-t.viewWidth,t.y=0;break;case e.LAYOUT_LEFT_CENTER:t.x=0,t.y=.5*(Laya.stage.height-t.viewHeight);break;case e.LAYOUT_CENTER:t.x=.5*(Laya.stage.width-t.viewWidth),t.y=.5*(Laya.stage.height-t.viewHeight);break;case e.LAYOUT_RIGHT_CENTER:t.x=Laya.stage.width-t.viewWidth,t.y=.5*(Laya.stage.height-t.viewHeight);break;case e.LAYOUT_LEFT_BOTTOM:t.x=0,t.y=Laya.stage.height-t.viewHeight;break;case e.LAYOUT_CENTER_BOTTOM:t.x=.5*(Laya.stage.width-t.viewWidth),t.y=Laya.stage.height-t.viewHeight;break;case e.LAYOUT_RIGHT_BOTTOM:t.x=Laya.stage.width-t.viewWidth,t.y=Laya.stage.height-t.viewHeight}}static SetWindowLayer(s){let i,a=0,n=0,r=s.GetViewStruct().isExclusion;switch(s.GetViewStruct().layerType){case e.TYPE_SCENE:if(r)for(n=t.GameLayer.fightLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.fightLayer.getChildAt(a),i&&i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.fightLayer.addChild(s);break;case e.TYPE_MAIN_DOWN:if(r)for(n=t.GameLayer.mainDownLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.mainDownLayer.getChildAt(a),i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.mainDownLayer.addChild(s);break;case e.TYPE_MAIN:if(r)for(n=t.GameLayer.mainLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.mainLayer.getChildAt(a),i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.mainLayer.addChild(s);break;case e.TYPE_WINDOW:if(r)for(n=t.GameLayer.windowLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.windowLayer.getChildAt(a),i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.windowLayer.addChild(s);break;case e.TYPE_ALERT:if(r)for(n=t.GameLayer.alertLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.alertLayer.getChildAt(a),i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.alertLayer.addChild(s);break;case e.TYPE_TOP:if(r)for(n=t.GameLayer.topLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.topLayer.getChildAt(a),i instanceof t.UIBaseWindow&&i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.topLayer.addChild(s);break;case e.TYPE_AD:if(r)for(n=t.GameLayer.adLayer.numChildren,a=n-1;a>=0;a--)i=t.GameLayer.adLayer.getChildAt(a),i.GetViewStruct().isExclusion&&t.UISystem.Inst.RemoveWindowView(i);t.GameLayer.adLayer.addChild(s)}}}e.TYPE_SCENE=1,e.TYPE_MAIN_DOWN=2,e.TYPE_MAIN=3,e.TYPE_WINDOW=4,e.TYPE_ALERT=5,e.TYPE_TOP=6,e.TYPE_AD=7,e.LAYOUT_LEFT_TOP=1,e.LAYOUT_CENTER_TOP=2,e.LAYOUT_RIGHT_TOP=3,e.LAYOUT_LEFT_CENTER=4,e.LAYOUT_CENTER=5,e.LAYOUT_RIGHT_CENTER=6,e.LAYOUT_LEFT_BOTTOM=7,e.LAYOUT_CENTER_BOTTOM=8,e.LAYOUT_RIGHT_BOTTOM=9,t.LayerType=e}(long||(long={})),function(t){class e{static registerClass(e,s,i,a=t.UrlUtils.UI){let n=t.UrlUtils.getFairyPkg(e,a);e&&!fgui.UIPackage.getByName(e)&&fgui.UIPackage.addPackage(n);let r=fgui.UIPackage.getItemURL(e,s);fgui.UIObjectFactory.setPackageItemExtension(r,i)}static createGObject(t,e){let s=null,i=t+"_"+e;if(s=Laya.Pool.getItem(i),s)return s.displayObject.active=!0,s;let a=this.poolCount.hasOwnProperty(i)?this.poolCount[i]:0,n=this.getUrl(t,e);return s=fgui.UIPackage.createObjectFromURL(n),s._id=i+"_"+a,a++,this.poolCount[i]=a,s.displayObject.active=!0,s}static recover(t){if(null!=t){let e=t.id.substr(0,t.id.lastIndexOf("_"));t.displayObject.active=!1,t.removeFromParent(),fgui.GTween.kill(t),Laya.Pool.recover(e,t)}}static getUrl(t,e){return fgui.UIPackage.getItemURL(t,e)}static loadUrl(t,e=null){let s=fgui.UIPackage.getItemByURL(t),i=s&&s.owner,a=i&&i._sprites[s.id],n=a&&a.atlas;if(n&&null==n.texture){let s=[{url:n.file,type:Laya.Loader.IMAGE}];fgui.AssetProxy.inst.load(s,Laya.Handler.create(this,(function(t,e,s){e.load(),s&&s.runWith(t)}),[t,n,e]))}else e&&e.runWith(t)}static getTextureBy(t,e){let s=this.getUrl(t,e);return this.getTexture(s)}static getTexture(t){let e=fgui.UIPackage.getItemByURL(t);return e&&e.load(),e?e.texture:null}static getItemAsset(t,e){let s=fgui.UIPackage.getItemURL(t,e);return fgui.UIPackage.getItemAssetByURL(s)}}e.poolCount={},t.PanelRegister=e}(long||(long={})),function(t){class e{constructor(){this.m_view=new t.Dictionary,this.m_gc_view=new t.Dictionary,Laya.timer.loop(t.Resource.CACHE_UI_TIME,e,e.CheckCache)}static get Inst(){return null==this._Inst&&(this._Inst=new e),this._Inst}static CheckCache(){let t=e.Inst.GetGcViewCache(),s=null;for(let e in t)s=t[e],s.IsCanGc()&&(s.Destroy(),delete t[e])}GetGcViewCache(){return this.m_gc_view}HasView(t){return null!=this.m_view[t]}GetViewByGc(t){let e=this.m_gc_view[t];return null!=e?(delete this.m_gc_view[t],e):null}CreateWindowView(t,e=null){if(null==t)return;let s=this.m_view[t];return null==s?(null==s&&(s=this.GetViewByGc(t),null==s&&(s=new t,s.cls=t),this.m_view[t]=s),s.Init(e),s.LoadAtlas(),s):void 0}RemoveWindowClass(t){this.RemoveWindowView(this.m_view[t])}RemoveWindowView(e){null!=e&&null!=e.parent&&e.cls in this.m_view&&(delete this.m_view[e.cls],this.m_gc_view[e.cls]=e,e.hide(),t.GameDispatcher.Inst.event(t.UIGameEvent.ON_HIDE_VIEW,e))}GetWindowView(t){return this.m_view[t]}GetWindowByName(t){let e;for(const s in this.m_view)if(e=this.m_view[s],e&&e.panelName==t)return e;return null}GetOpenViews(){let t,e=[];for(let s in this.m_view)t=this.m_view[s],t&&e.push(t);return e}removeAllFromMain(e=null){let s,i=this.GetOpenViews();for(let a=i.length-1;a>=0;a--)if(s=i[a],s instanceof t.UIBaseWindow){if(s.GetViewStruct().layerType==t.LayerType.TYPE_SCENE||s.GetViewStruct().layerType==t.LayerType.TYPE_MAIN_DOWN||s.GetViewStruct().layerType==t.LayerType.TYPE_MAIN)continue;null!=e&&-1!=e.indexOf(s.GetViewStruct().layerType)||this.RemoveWindowView(s)}}removeAllView(){let e,s=this.GetOpenViews();for(let i=s.length-1;i>=0;i--)e=s[i],e instanceof t.UIBaseWindow&&this.RemoveWindowView(e)}hasAnyViewOnMain(e=null){let s,i=this.GetOpenViews();for(let a=i.length-1;a>=0;a--)if(s=i[a],s instanceof t.UIBaseWindow){if(s.GetViewStruct().layerType==t.LayerType.TYPE_SCENE||s.GetViewStruct().layerType==t.LayerType.TYPE_MAIN_DOWN||s.GetViewStruct().layerType==t.LayerType.TYPE_MAIN||s.GetViewStruct().layerType==t.LayerType.TYPE_AD)continue;if(e&&-1!=e.indexOf(s))continue;if(e&&-1!=e.indexOf(s.cls))continue;return!0}return!1}hasAnyShowBanner(){let t;for(t in this.m_view){let e=this.m_view[t];if(e&&e.isShowBanner)return!0}return!1}GetPanelByName(e){let s,i=this.GetOpenViews();for(let a=i.length-1;a>=0;a--)if(s=i[a],s instanceof t.UIBaseWindow&&s.panelName==e)return s;return null}getTopWindow(e=null){let s,i=-1,a=null;for(s in this.m_view){let n=this.m_view[s];if(n instanceof t.UIBaseWindow&&n.parent){if(n.GetViewStruct().isAdLayer)continue;if(e&&-1!=e.indexOf(n.cls))continue;let t=fgui.GRoot.inst.getChildIndex(n.parent);t>i&&(a=n,i=t)}}return a}static showLoadingLeaf(){}static hideLoadingLeaf(){}}t.UISystem=e}(long||(long={})),function(t){class e extends fgui.GComponent{constructor(){super(),this.discriminator="I-AM-IComponent",this.canCallShow=!0,this.m_eventPool=null,this.m_param=null,this.$gid=0,this.m_eventPool=new t.EventPool,this.$gid=Laya.Utils.getGID()}onConstruct(){super.onConstruct(),this.InitFairyGui(),this.InitUI()}InitFairyGui(){}InitUI(){this.c1=this.getController("c1")}show(e){t.CheckComponent(this,"show")}get Data(){return this.m_param}AddListener(){t.CheckComponent(this,"AddListener")}RemoveListener(){t.CheckComponent(this,"RemoveListener")}AddGameListener(t,e,s,i){this.m_eventPool.AddListenerInPool(t,e,s,i)}RemoveGameListener(t,e,s,i){this.m_eventPool.RemoveListenerFromPool(t,e,s,i)}addComponent(t){let e=this.displayObject&&this.displayObject.addComponent(t);return e.$owner=this,e}hide(){let e,s=this.displayObject.getComponents(Laya.Component);if(s)for(let t=s.length-1;t>=0;t--)e=s[t],e&&e.destroy();null!=this.m_eventPool&&this.m_eventPool.Reset(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),fgui.GTween.kill(this),t.CheckComponent(this,"hide")}Destroy(){this.m_eventPool&&(this.m_eventPool.Reset(),this.m_eventPool=null),this.m_param=null,t.CheckComponent(this,"Destroy")}}t.TComponent=e;class s extends e{constructor(){super(),this.cls=null,this.gcTime=0}Init(t){this.m_param=t,this.gcTime=Number.MAX_VALUE}onResize(){}get Data(){return this.m_param}hide(){super.hide(),this.gcTime=Laya.timer.currTimer+t.Resource.CACHE_UI_TIME}IsCanGc(){return Laya.timer.currTimer>=this.gcTime}Destroy(){super.Destroy(),this.cls=null}}t.View=s;t.UIBaseWindow=class extends s{constructor(e="",s="",i=t.UrlUtils.UI){super(),this._pkgName="",this._resName="",this._view=null,this.m_mask=null,this.m_imgBg=null,this.btn_close=null,this.viewStruct=null,this._btns=null,this._isLoaded=!1,this._iRes=null,this.isReset=!1,this.ui_res=null,this._isShowbanner=!1,this._bannerData=null,this.isLockBanner=!1,this.name=e,this._pkgName=e,this._resName=s,this.ui_res=i,this._btns=[],this.SetViewStruct(),Object.defineProperty(this,"viewWidth",{get:function(){return this._view&&this._view.viewWidth}}),Object.defineProperty(this,"viewHeight",{get:function(){return this._view&&this._view.viewHeight}})}LoadAtlas(){this.visible=!1,this.isReset=!1,this.isLoaded?this.onDelay():(fgui.UIPackage.getByName(this._pkgName)||this.showLoadingLeaf(),t.LoadQueue.Inst.loadUI(this._pkgName,Laya.Handler.create(this,this.onLoaded),!0,this.ui_res))}showLoadingLeaf(){this.viewStruct.isShowLoadCircle}hideLoadingLeaf(){this.viewStruct.isShowLoadCircle}onLoaded(t){if(this.hideLoadingLeaf(),null==t||this.isReset)return;this._iRes=t,t.GetRes()&&this.loadComplete()}loadComplete(){let e=this;if(e._isLoaded=!0,e.registerClasses(),e._view=fgui.UIPackage.createObject(e._pkgName,e._resName),!(e._view instanceof fgui.GComponent))throw new Error(`暂无界面 ${e._pkgName}_${e._resName}`);e.setSize(e._view.viewWidth,e._view.viewHeight),e.addChild(e._view),e._view.name=e._resName,t.FairyUtils.setVar(e._view,e,e._btns),e.InitUI(),e.onDelay(),t.GameDispatcher.Inst.event(t.UIGameEvent.ON_SHOW_VIEW,this)}onDelay(){let e=this;t.LayerType.SetWindowLayer(e),e.visible=!0,e.viewStruct.isShowMaskBg?e.showMask():e.hideMask(),e.viewStruct.isShowImgBg?e.showImgBg():e.hideImgBg(),e.onResize(),e.AddListener(),e.show(e.m_param),e._view instanceof fgui.GComponent&&e.viewStruct.isEffect&&t.EffectUtil.openWindowEffect(e._view,this.onEffectEnd,this),this.OpenWindow()}registerClasses(){}InitUI(){this.c1=this._view instanceof fgui.GComponent&&this._view.getController("c1"),Laya.Browser.onMiniGame?t.Global.isWxmj&&this.c1&&this.c1.hasPage("wxmj")?this.c1.selectedPage="wxmj":this.c1&&this.c1.hasPage("wx")&&(this.c1.selectedPage="wx"):Laya.Browser.onTTMiniGame?this.c1&&this.c1.hasPage("tt")&&(this.c1.selectedPage="tt"):t.Global.is233?this.c1&&this.c1.hasPage("233")&&(this.c1.selectedPage="233"):Laya.Browser.onQGMiniGame?this.c1&&this.c1.hasPage("oppo")&&(this.c1.selectedPage="oppo"):Laya.Browser.onVVMiniGame&&this.c1&&this.c1.hasPage("vivo")&&(this.c1.selectedPage="vivo")}AddListener(){super.AddListener();for(let t of this._btns)t.onClick(this,this.onBtnClick,[t])}RemoveListener(){super.RemoveListener();for(let t of this._btns)t.offClick(this,this.onBtnClick)}show(e){this.m_param=e,t.CheckComponent(this._view,"show")}onEffectEnd(){}OpenWindow(){this.viewStruct.isCtrlTimerScale}CloseWindow(){this.viewStruct.isCtrlTimerScale}get isLoaded(){return this._isLoaded}onBtnClick(e){"none"!=e.sound&&(e.sound?0!=e.sound.indexOf("ui://")&&t.SoundMgr.Inst.play(e.sound):t.SoundMgr.Inst.play(t.SoundMgr.click)),e==this.btn_close&&this.onBtnCloseClick()}onBtnCloseClick(){this.close()}close(){t.UISystem.Inst.RemoveWindowClass(this.cls)}SetViewStruct(){null==this.viewStruct&&(this.viewStruct=new t.ViewStruct)}get panelName(){return this._resName}GetViewStruct(){return this.viewStruct}onResize(){if(t.LayerType.SetWindowLayout(this),null!=this.m_mask){this.m_mask.viewWidth=Laya.stage.width,this.m_mask.viewHeight=Laya.stage.height;let t=this.m_mask.getChild("img").asImage;t.width=Laya.stage.width,t.height=Laya.stage.height,this.m_mask.x=-this.x,this.m_mask.y=-this.y}null!=this.m_imgBg&&(this.m_imgBg.width=Laya.stage.width,this.m_imgBg.height=Laya.stage.height,this.m_imgBg.x=-this.x,this.m_imgBg.y=-this.y),this.resetScrollRect()}resetScrollRect(){Laya.stage.scrollRect?this.viewStruct.layout==t.LayerType.LAYOUT_CENTER?this.setXY(Laya.stage.scrollRect.x+.5*(Laya.stage.width-this.viewWidth),Laya.stage.scrollRect.y+.5*(Laya.stage.height-this.viewHeight)):this.setXY(Laya.stage.scrollRect.x,Laya.stage.scrollRect.y):this.setXY(0,0)}showMask(){null==this.m_mask&&(this.m_mask=fgui.UIPackage.createObject("common",this.viewStruct.maskName).asCom,this.addChildAt(this.m_mask,0),this.m_mask.touchable=!0,this.m_mask.alpha=this.viewStruct.mashBgAlpha)}hideMask(){null!=this.m_mask&&(null!=this.m_mask.parent&&this.m_mask.parent.removeChild(this.m_mask),this.m_mask=null)}showImgBg(){null==this.m_imgBg&&(this.m_imgBg=fgui.UIPackage.createObject("common","bg").asImage,this.addChildAt(this.m_imgBg,0))}hideImgBg(){null!=this.m_imgBg&&(null!=this.m_imgBg.parent&&this.m_imgBg.parent.removeChild(this.m_mask),this.m_imgBg=null)}set isThrough(t){this._view instanceof fgui.GComponent&&(this._view.opaque=!t)}get isThrough(){return this._view instanceof fgui.GComponent&&!this._view.opaque}setSize(t,e,s){super.setSize(t,e,s),this._view instanceof fgui.GComponent&&this._view.setSize(t,e,s)}getController(t){return this._view instanceof fgui.GComponent&&this._view.getController(t)}getTransition(t){return this._view instanceof fgui.GComponent&&this._view.getTransition(t)}hide(){this.removeFromParent(),this.RemoveListener(),this.isReset=!0,this.CloseWindow(),this.viewStruct.isEffect&&fgui.GTween.kill(this._view),Laya.timer.clearAll(this),Laya.updateTimer.clearAll(this),Laya.Tween.clearAll(this),fgui.GTween.kill(this),this.m_param=null,this.hideBanner(),this.hideInsertAd(),super.hide()}get ui(){return this._view}Destroy(){super.Destroy(),this.hideMask(),this.hideImgBg(),null!=this._iRes&&(this._iRes.Dispose(),this._iRes=null),this._view instanceof fgui.GComponent&&(this._view.dispose(),this._view=null),this._isLoaded=!1,this._resName=""}showBanner(e=null){this._bannerData=e,this._isShowbanner=!0,t.GameDispatcher.Inst.event(t.UIGameEvent.SHOW_BANNER,this._bannerData)}get isShowBanner(){return!this.isLockBanner&&this._isShowbanner}reshowBanner(){this.showBanner(this._bannerData)}hideBanner(){this.isLockBanner=!1,this._isShowbanner=!1,this._bannerData=null,t.GameDispatcher.Inst.event(t.UIGameEvent.HIDE_BANNER)}showInsertAd(e=null){t.GameDispatcher.Inst.event(t.UIGameEvent.SHOW_INSERT,e)}hideInsertAd(){t.GameDispatcher.Inst.event(t.UIGameEvent.HIDE_INSERT)}}}(long||(long={})),function(t){t.ViewStruct=class{constructor(){this.layerType=t.LayerType.TYPE_WINDOW,this.layout=t.LayerType.LAYOUT_CENTER,this.isShowMaskBg=!1,this.mashBgAlpha=.7,this.isShowImgBg=!1,this.maskName="sp_mask",this.isExclusion=!0,this.isEffect=!1,this.isCtrlTimerScale=!1,this.isShowLoadCircle=!1}get isAdLayer(){return this.layerType==t.LayerType.TYPE_AD}}}(long||(long={})),function(t){class e extends fgui.GProgressBar{constructor(){super(),this.discriminator="I-AM-IComponent",this.canCallShow=!0,this._data=null}Init(t){}onConstruct(){super.onConstruct(),t.FairyUtils.setVar(this,this),this.InitUI()}InitUI(){}AddListener(){}RemoveListener(){}show(t){this._data=t}get Data(){return this._data}hide(){this._data=null}Destroy(){}}t.BaseProgressBar=e}(long||(long={})),function(t){t.ChessGrid=class{constructor(t=10,e=10,s=80,i=80){this.singleWidth=80,this.singleHeight=80,this.x=0,this.y=0,this.row=10,this.list=10,this.gapW=0,this.gapH=0,this._range=new Laya.Rectangle,this.graphics=null,this.setGrid(t,e,s,i)}setPos(t,e){this.x=t,this.y=e}setGrid(t,e,s=80,i=80){this.row=t,this.list=e,this.singleWidth=s,this.singleHeight=i}get gridWidth(){return this.list*this.singleWidth+(this.list-1)*this.gapW}get gridHeight(){return this.row*this.singleHeight+(this.row-1)*this.gapH}getXYAt(t,e){let s=e*(this.singleWidth+this.gapW),i=t*(this.singleHeight+this.gapH),a=new Laya.Point(s,i);return this.contains(a)?a:null}getGridByPos(t,e){if(!this.range.contains(t,e))return null;return{row:Math.floor((e-this.y)/(this.singleHeight+this.gapH)),list:Math.floor((t-this.x)/(this.singleWidth+this.gapW))}}containsRL(t,e){return null!=this.getXYAt(t,e)}contains(t){return t&&this.range.contains(t.x,t.y)}get range(){return this._range.setTo(this.x,this.y,this.gridWidth,this.gridHeight),this._range}setGraphics(t){this.graphics=t}drawGridWith(e,s,i="#00ff00"){let a=this.graphics;if(!a)return;a.clear(),a.save();let n=this.gridWidth*e,r=this.gridHeight*s,l=(this.singleWidth+this.gapW)*e,o=(this.singleHeight+this.gapH)*s,h=t.ColorUtil.toRGBA(i,1);a.translate(this.x,this.y);for(let t=0;t<=n;t+=l)a.drawLine(t,0,t,r,h,1);for(let t=0;t<=r;t+=o)a.drawLine(0,t,n,t,h,1);a.restore()}drawGrid(e=null,s="#00ff00"){if(!(e=e||this.graphics))return;e.clear(),e.save();let i=t.ColorUtil.toRGBA(s,1);e.translate(this.x,this.y);for(let t=0;t<=this.gridWidth;t+=this.singleWidth+this.gapW)e.drawLine(t,0,t,this.gridHeight,i,1);for(let t=0;t<=this.gridHeight;t+=this.singleHeight+this.gapH)e.drawLine(0,t,this.gridWidth,t,i,1);e.restore()}drawCircle(e=null,s,i,a="#ffcc00",n=1,r="#ff00ff",l=1){if(!(e=e||this.graphics))return;a=t.ColorUtil.toRGBA(a,n),r=t.ColorUtil.toRGBA(r,l);let o=i*(this.singleWidth+this.gapW),h=s*(this.singleHeight+this.gapH),c=this.singleWidth>>1,u=this.singleHeight>>1,d=Math.ceil(Math.sqrt(c*c+u*u)),g=Math.ceil(d/Math.sqrt(2));e.drawCircle(o+c,h+u,g,a,r,1)}drawCircleAt(e=null,s,i,a="#ffcc00",n=1,r="#ff00ff",l=1){if(!(e=e||this.graphics))return;a=t.ColorUtil.toRGBA(a,n),r=t.ColorUtil.toRGBA(r,l);let o=this.singleWidth>>1,h=this.singleHeight>>1,c=Math.ceil(Math.sqrt(o*o+h*h)),u=Math.ceil(c/Math.sqrt(2));e.drawCircle(s+o,i+h,u,a,r,1)}clear(){this.graphics&&this.graphics.clear()}}}(long||(long={})),function(t){t.TMoveClip=class{constructor(){this.fps=60,this.interval=0,this.swing=!1,this.repeatDelay=0,this.timeScale=1,this._playing=!1,this._frameCount=0,this._frame=0,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this._endHandler=null,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this._frames=null,this.setPlaySettings()}static createFrames(e,s="IconProp",i=1){let a,n,r=[];for(let l=0;l<i;l++){let i=e+"_"+(l<10?"0"+l:l);a=t.PanelRegister.getTextureBy(s,i),0!=l||a||(a=t.PanelRegister.getTextureBy(s,e)),a&&(n=Laya.Pool.getItem("fgui.Frame")||new fgui.Frame,n.texture=a,r.push(n))}return r}get frames(){return this._frames}set frames(t){this._frames=t,null!=this._frames?(this._frameCount=this._frames.length,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._frame<0||this._frame>this._frameCount-1)&&(this._frame=this._frameCount-1),this._frameElapsed=0,this._repeatedCount=0,this._reversed=!1):this._frameCount=0,this.drawFrame(),this.checkTimer();let e=60/this.fps;this.interval=this._frames?Math.ceil(1e3*e/this._frames.length):Math.ceil(1e3*e/30)}get frameCount(){return this._frameCount}get frame(){return this._frame}set frame(t){this._frame!=t&&(null!=this._frames&&t>=this._frameCount&&(t=this._frameCount-1),this._frame=t,this._frameElapsed=0,this.drawFrame())}get playing(){return this._playing}set playing(t){this._playing!=t&&(this._playing=t,this.checkTimer())}rewind(){this._frame=0,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this.drawFrame()}syncStatus(t){this._frame=t._frame,this._frameElapsed=t._frameElapsed,this._reversed=t._reversed,this._repeatedCount=t._repeatedCount,this.drawFrame()}advance(t){for(var e=this._frame,s=this._reversed,i=t;;){var a=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(a+=this.repeatDelay),t<a){this._frameElapsed=0;break}if(t-=a,this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),this._frame==e&&this._reversed==s){var n=i-t;t-=Math.floor(t/n)*n}}this.drawFrame()}setPlaySettings(t=0,e=-1,s=0,i=-1,a=null){this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=s,this._endAt=i,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._endHandler=a,this.frame=t}update(){if(this._playing&&0!=this._frameCount&&3!=this._status){var t=Laya.timer.delta;t>100&&(t=100),1!=this.timeScale&&(t*=this.timeScale),this._frameElapsed+=t;var e=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(e+=this.repeatDelay),!(this._frameElapsed<e)){if(this._frameElapsed-=e,this._frameElapsed>this.interval&&(this._frameElapsed=this.interval),this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),1==this._status)this._frame=this._start,this._frameElapsed=0,this._status=0;else if(2==this._status){if(this._frame=this._endAt,this._frameElapsed=0,this._status=3,null!=this._endHandler){var s=this._endHandler;this._endHandler=null,s.run()}}else this._frame==this._end&&(this._times>0?(this._times--,0==this._times?this._status=2:this._status=1):0!=this._start&&(this._status=1));this.drawFrame()}}}drawFrame(){if(this._frameCount>0&&this._frame<this._frames.length){var t=this._frames[this._frame];this.texture=t.texture}else this.texture=null}checkTimer(){this._playing&&this._frameCount>0?(Laya.updateTimer.clear(this,this.update),Laya.updateTimer.frameLoop(1,this,this.update)):Laya.updateTimer.clear(this,this.update)}play(t=0,e=null){this._playing=!1,Laya.updateTimer.clear(this,this.update),this.setPlaySettings(0,-1,t,-1,e),this.rewind()}startRender(){this.playing=!0}pauseRender(){this.playing=!1}stop(){this.pauseRender(),this._frame=0}recoverFrames(){let t=null;for(;this._frames&&this._frames.length>0;)t=this._frames.pop(),t&&(t.addDelay=0,t.texture=null,Laya.Pool.recover("fgui.Frame",t))}clear(){this.stop(),this._frame=0,this._frameCount=0,this._status=0,this._repeatedCount=0,this.texture=null,this._frames=null,Laya.updateTimer.clear(this,this.update),Laya.updateTimer.clearAll(this)}}}(long||(long={})),function(t){function isIListItem(t){return"I-AM-IComponent"==t.discriminator&&"I-AM-IListItem"==t.discriminator2}t.isIListItem=isIListItem;class e extends Laya.EventDispatcher{constructor(t,s=null){super(),this.discriminator="I-AM-IComponent",this.canCallShow=!0,this.list=null,this._data=null,this._thisObject=null,this._itemRenderer=null,this.isAutoSize=!1,this.isAutoScroll=!1,this.autoHScrollSpeed=1,this.autoVScrollSpeed=1,this.autoVScrollInitY=0,this._preSelectedIndex=-1,this.stageMouseDown=!1,this.focusItem=null,this.doScrollEffect=!1,this.list=t,this._thisObject=s,this._data=[],null!=this.list&&(this._thisObject=s||this,this.list.itemRenderer=new Laya.Handler(this,this.listItemRender,null,!1),this.list.scrollPane&&this.list.setVirtual(),this.list[e.EGLIST]=this)}listItemRender(e,s){this.array&&(s instanceof t.TComponent||s instanceof t.TBaseButton)&&s.show(this.array[e])}AddListener(){Laya.timer.clear(this,this.loopVScroll),Laya.timer.clear(this,this.loopHScroll),fgui.GTween.kill(this),this.list.on(fgui.Events.CLICK_ITEM,this,this.clickItem),this.list.on(fgui.Events.SCROLL,this,this.listScroll),this.list.on(fgui.Events.SCROLL_END,this,this.listScrollEnd),this.isAutoScroll&&(Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.mouseUp))}RemoveListener(){this.list.off(fgui.Events.CLICK_ITEM,this,this.clickItem),this.list.off(fgui.Events.SCROLL,this,this.listScroll),this.list.off(fgui.Events.SCROLL_END,this,this.listScrollEnd),this.list.off(fgui.Events.SCROLL,this,this.doSpecialEffect),Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.mouseDown),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.mouseUp)}show(t){Laya.timer.clear(this,this.loopVScroll),Laya.timer.clear(this,this.loopHScroll),fgui.GTween.kill(this),this._data=t,t instanceof Array&&(this.array=t)}get isSingle(){return this.list.selectionMode==fgui.ListSelectionMode.Single}set selectionMode(t){this.list.selectionMode=t}get selectionMode(){return this.list.selectionMode}clickItem(t){this.isSingle&&this._preSelectedIndex!=this.list.selectedIndex||-1==this._preSelectedIndex?this.selectItem(t):this.isSingle||this.selectItem(t),this._preSelectedIndex=this.list.selectedIndex,isIListItem(t)&&(this.focusItem&&(this.focusItem.isFocus=!1),this.focusItem!=t&&(this.focusItem=t,this.focusItem.isFocus=!0,this.event(Laya.Event.FOCUS,t)))}selectItem(t){this.event(fgui.Events.CLICK_ITEM,t)}set itemUrl(t){this.list.defaultItem=t}get itemUrl(){return this.list.defaultItem}set numItems(t){this.list.numItems=t}get numItems(){return this.list.numItems}set data(t){this.list.data=t}get data(){return this.list.data}set array(t){this.focusItem&&(this.focusItem.isFocus=!1),this._data=t||[],this.list.numItems=this._data.length,this.setAutoSize()}get array(){return this._data}get Data(){return this._data}getSelection(t){return this.list.getSelection(t)}setArray(t,e=!1,s=.5){this.focusItem&&(this.focusItem.isFocus=!1),this.doScrollEffect=e,e&&this.list.setVirtualAndLoop(),this.array=t,this.isSingle&&(this.scrollToTop(),this._preSelectedIndex=-1,this.selectedIndex=0),e&&(this.list.off(fgui.Events.SCROLL,this,this.doSpecialEffect),this.list.on(fgui.Events.SCROLL,this,this.doSpecialEffect,[s]),this.doSpecialEffect(s))}doSpecialEffect(t=.5){for(var e=this.list.scrollPane.posX+this.list.viewWidth/2,s=this.list.numChildren,i=0;i<s;i++){var a=this.list.getChildAt(i),n=Math.abs(e-a.x-a.width/2);if(n>a.width)a.setScale(1,1);else{var r=1+(1-n/a.width)*t;a.setScale(r,r)}}this._preSelectedIndex=-1;let l=(this.list.getFirstChildInView()+1)%this.list.numItems;this.selectedIndex=l,this.event(fgui.Events.SCROLL)}setPosX(t,e){this.list&&this.list.scrollPane&&this.list.scrollPane.setPosX(t,e)}canelSelect(){this._preSelectedIndex=-1,this.list.clearSelection()}setAutoSize(){if(this.isAutoSize){let t=0,e=0,s=null;if(this.isHScroll){for(let e=0;e<this.list.numChildren;e++)s=this.list.getChildAt(e),null!=s&&(t+=s.width);t+=this._data.length>1?(this._data.length-1)*this.list.columnGap:0,this.list.setSize(t,this.list.height)}else if(this.isVScroll){for(let t=0;t<this.list.numChildren;t++)s=this.list.getChildAt(t),null!=s&&(e+=s.height);e+=this._data.length>1?(this._data.length-1)*this.list.lineGap:0,this.list.setSize(this.list.width,e)}}if(this.isAutoScroll)if(this.isHScroll){this.contentWidth-this.list.viewWidth>0&&Laya.timer.frameLoop(1,this,this.loopHScroll)}else if(this.isVScroll){this.contentHeight-this.list.viewHeight>0&&Laya.timer.frameLoop(1,this,this.loopVScroll)}}loopVScroll(){t.ObjectUtils.globalIsIn(this.list)&&this.stageMouseDown||this.isScrollTween||(this.list.scrollPane.posY+=this.autoVScrollSpeed)}loopHScroll(){t.ObjectUtils.globalIsIn(this.list)&&this.stageMouseDown||this.isScrollTween||(this.list.scrollPane.posX+=this.autoHScrollSpeed)}setSize(t,e,s){this.list.setSize(t,e,s)}getAllWidth(t=60,e=!0){if(this.isHScroll)return this.list.height;if(e){let t=0,e=null;for(let s=0;s<this.list.numChildren;s++)e=this.list.getChildAt(s),null!=e&&(t+=e.width);return t+=this._data.length>1?(this._data.length-1)*this.list.columnGap:0,t}{let e=this.list.getChildAt(0),s=(e?e.width:t)*this._data.length;return s+=this._data.length>1?(this._data.length-1)*this.list.columnGap:0,s}}getAllHeight(t=60,e=!0){if(this.isHScroll)return this.list.height;if(e){let t=0,e=null;for(let s=0;s<this.list.numChildren;s++)e=this.list.getChildAt(s),null!=e&&(t+=e.height);return t+=this._data.length>1?(this._data.length-1)*this.list.lineGap:0,t}{let e=this.list.getChildAt(0),s=(e?e.height:t)*this._data.length;return s+=this._data.length>1?(this._data.length-1)*this.list.lineGap:0,s}}mouseDown(){this.stageMouseDown=!0}mouseUp(){this.stageMouseDown=!1,this.focusItem&&!this.focusItem.globalIsIn()&&(this.focusItem.isFocus=!1,this.focusItem=null)}rightClickItem(t){isIListItem(t)&&(this.focusItem&&(this.focusItem.isFocus=!1),t.isFocus=!0,this.focusItem=t)}listScroll(){this.event(fgui.Events.SCROLL)}listScrollEnd(){this.mouseUp(),this.event(fgui.Events.SCROLL_END)}get displayObject(){return this.list}InitUI(){}get numChildren(){return this.list&&this.list.numChildren}getChildAt(t){return this.list&&this.list.getChildAt(t)}get items(){let t=[];for(let e=0;e<this.list.numChildren;e++)t.push(this.list.getChildAt(e));return t}set visible(t){this.list.visible=t}get visible(){return this.list.visible}get scrollPane(){return this.list.scrollPane}killTween(){return this.scrollPane&&this.scrollPane.killTween()}get isScrollTween(){return this.scrollPane&&0!=this.scrollPane._tweening}get viewWidth(){return this.list.viewWidth}get viewHeight(){return this.list.viewHeight}setScale(t,e){this.list&&this.list.setScale(t,e)}setVirtual(){this.list.scrollPane&&this.list.setVirtual()}setVirtualAndLoop(){this.list.scrollPane&&(this.list._virtual=!1,this.list.setVirtualAndLoop())}get scrollType(){return this.list&&this.list.scrollPane&&this.list.scrollPane._scrollType}get isVScroll(){return this.list.layout==fgui.ListLayoutType.SingleColumn||this.scrollType==fgui.ScrollType.Vertical}get isHScroll(){return this.list.layout==fgui.ListLayoutType.SingleRow||this.scrollType==fgui.ScrollType.Horizontal}set touchable(t){this.list&&(this.list.touchable=t)}get touchable(){return this.list&&this.list.touchable}set isTouchScroll(t){this.list&&this.list.scrollPane&&(this.list.scrollPane.touchEffect=t)}get isTouchScroll(){return this.list&&this.list.scrollPane&&this.list.scrollPane.touchEffect}get isBoth(){return this.scrollType==fgui.ScrollType.Both}get contentWidth(){return this.list.scrollPane?this.list.scrollPane.contentWidth:this.list.width}get contentHeight(){return this.list.scrollPane?this.list.scrollPane.contentHeight:this.list.height}get width(){return this.list?this.list.width:0}get height(){return this.list?this.list.height:0}set height(t){this.list&&(this.list.height=t)}set x(t){this.list.x=t}get x(){return this.list.x}set y(t){this.list.y=t}get y(){return this.list.y}setInitSelectedIndex(){this.list.selectedIndex=0,this._preSelectedIndex=-1}set listSelectedIndex(t){this.list.selectedIndex=t}set selectedIndex(t){this.list.selectedIndex=t;let e=null;for(let s=0;s<this.list.numChildren;s++)if(e=this.list.getChildAt(s),this._data&&e.Data==this._data[t]){this.clickItem(e);break}this._preSelectedIndex=t}get selectedIndex(){return-1==this.list.selectedIndex?0:this.list.selectedIndex}get selectData(){return-1==this._preSelectedIndex?null:this._data&&this._data[this._preSelectedIndex]}toPrev(){this.list.scrollPane&&this.list.scrollPane.scrollLeft(1,!0)}toNext(){this.list.scrollPane&&this.list.scrollPane.scrollRight(1,!0)}scrollToView(t,e=!1,s=!1){this.list.scrollToView(t,e,s)}set scrollEnabled(t){this.list.scrollPane&&(this.list.scrollPane.touchEffect=t)}get scrollEnabled(){return this.list.scrollPane&&this.list.scrollPane.touchEffect}scrollLeft(t,e){null!=this.list.scrollPane&&this.list.scrollPane.scrollLeft(t,e)}scrollRight(t,e){null!=this.list.scrollPane&&this.list.scrollPane.scrollRight(t,e)}scrollToTop(t){null!=this.list.scrollPane&&this.list.scrollPane.scrollTop(t)}scrollToBottom(t){null!=this.list.scrollPane&&this.list.scrollPane.scrollBottom(t)}scrollUp(t=1){this.list.scrollPane.scrollStep=t,null!=this.list.scrollPane&&this.list.scrollPane.scrollUp()}scrollDown(t=1){this.list.scrollPane.scrollStep=t,null!=this.list.scrollPane&&this.list.scrollPane.scrollDown()}set lineCount(t){this.list.lineCount=t}get lineCount(){return this.list.lineCount}set columnCount(t){this.list.columnCount=t}get columnCount(){return this.list.columnCount}set lineGap(t){this.list.lineGap=t}get lineGap(){return this.list.lineGap}set columnGap(t){this.list.columnGap=t}get columnGap(){return this.list.columnGap}get GList(){return this.list}localToGlobal(t,e){return this.list.localToGlobal(t,e)}hide(){let t;for(let e=0;e<this.numChildren;e++)t=this.getChildAt(e),isIListItem(t)&&t.hide&&t.hide();fgui.GTween.kill(this),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),Laya.timer.clear(this,this.loopVScroll),Laya.timer.clear(this,this.loopHScroll),this._data=null,this._preSelectedIndex=-1,this.focusItem&&(this.focusItem.isFocus=!1),this.focusItem=null}Destroy(){this.hide()}}e.EGLIST="$eglist",t.EGList=e}(long||(long={})),function(t){class e extends fgui.GButton{constructor(){super(),this.discriminator="I-AM-IComponent",this.canCallShow=!0,this.m_data=null,this.initTouchEffect=0,this._btns=null,this._isFocus=!1,this.$gid=0,this.$gid=Laya.Utils.getGID()}onConstruct(){super.onConstruct(),this._btns=[],t.FairyUtils.setVar(this,this,this._btns),this.initTouchEffect=this._downEffect,this.InitUI()}InitUI(){this.c1=this.getController("c1")}AddListener(){}RemoveListener(){}show(t){this.m_data=t,this.AddListener()}get Data(){return this.m_data}set isFocus(t){this._isFocus=t}get isFocus(){return this._isFocus}set selectedPage(t){this.c1=this.c1||this.getController("c1"),null!=this.c1&&(this.c1.selectedPage=t),this.updateState()}get selectedPage(){return this.c1&&this.c1.selectedPage}hasPage(t){return this.c1&&this.c1.hasPage(t)}updateState(){}set touchEffect(t){this._downEffect=t?this.initTouchEffect:0}get touchEffect(){return 0!=this._downEffect}set touchEffectValue(t){this._downEffectValue=t}get touchEffectValue(){return this._downEffectValue}addComponent(t){let e=this.displayObject&&this.displayObject.addComponent(t);return e.$owner=this,e}hide(){let t,e=this.displayObject.getComponents(Laya.Component);if(e)for(let s=e.length-1;s>=0;s--)t=e[s],t&&t.destroy();this.RemoveListener(),fgui.GTween.kill(this),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.m_data=null}Destroy(){this.hide(),this.isDisposed||this.dispose()}}t.TBaseButton=e;t.TListButtonItem=class extends e{constructor(){super(),this.discriminator2="I-AM-IListItem",this.m_eventPool=null,this._isFocus=!1,this.m_eventPool=new t.EventPool}onConstruct(){super.onConstruct()}set isFocus(t){this._isFocus=t}get isFocus(){return this._isFocus}setIcon(e){t.PanelRegister.loadUrl(e,Laya.Handler.create(this,t=>{this.icon=t}))}show(t){super.show(t)}AddListener(){if(this._btns){let t;for(let e=0;e<this._btns.length;e++)t=this._btns[e],t&&t.onClick(this,this.onBtnClick,[t])}t.CheckComponent(this,"AddListener")}RemoveListener(){if(this._btns){let t;for(let e=0;e<this._btns.length;e++)t=this._btns[e],t&&t.offClick(this,this.onBtnClick)}t.CheckComponent(this,"RemoveListener")}AddGameListener(t,e,s,i){this.m_eventPool.AddListenerInPool(t,e,s,i)}RemoveGameListener(t,e,s,i){this.m_eventPool.RemoveListenerFromPool(t,e,s,i)}get eglistParent(){let e=t.ObjectUtils.getParentOf(fgui.GList,this);return e&&e.$eglist}globalIsIn(t=null){return this.globalIsInRange(t)}globalIsInRange(e=null,s=null){return t.ObjectUtils.globalIsInRange(e,s,this)}onBtnClick(e){e.sound?0!=e.sound.indexOf("ui://")&&t.SoundMgr.Inst.play(e.sound):t.SoundMgr.Inst.play(t.SoundMgr.click);let s=this.parent&&this.parent.$eglist;s&&s.event(t.UIGameEvent.CLICK_LIST_BUTTON,[e,this])}hide(){super.hide(),null!=this.m_eventPool&&this.m_eventPool.Reset(),t.CheckComponent(this,"hide")}Destroy(){t.CheckComponent(this,"Destroy"),this.m_eventPool&&(this.m_eventPool=null),this.m_data=null}};t.TSpineButton=class extends e{constructor(){super(),this.spineName=null,this.iRes=null,this.skeleton=null,this.isLoop=!0,this.isOverRemove=!1,this.handler=null,this._isLoad=!1,this.touchable=!0}InitUI(){super.InitUI()}show(t){if(super.show(t),this._iconObject instanceof fgui.GLoader&&(this.visible=this._iconObject.visible=""!=this._iconObject.icon),"string"==typeof t)this.play(t);else if("object"==typeof t&&t.spineName){let e=!t.hasOwnProperty("isLoop")||t.isLoop,s=t.handler;this.play(t.spineName,NaN,NaN,e,!1,s,t.aniName,t)}}play(e,s=NaN,i=NaN,a=!0,n=!1,r=null,l=null,o=null){if(this.spineName==e)return;this.hide(),this.m_data=o,this.visible=!0,this.spineName=e,this.isLoop=a,this.isOverRemove=n,this.handler=r;let h=t.UrlUtils.GetSpineUrl(e);t.LoadQueue.Inst.loadSpine(h,Laya.Handler.create(this,this.onComplete,[e,l,s,i]))}onComplete(t,e,s,i,a){if(this._isLoad=!0,this.iRes=a,this.skeleton=a.GetRes().buildArmature(0),!this.skeleton||this.skeleton.destroyed||this.isDisposed)return void console.error("spine资源已释放!!! spineName: "+t+" aniName: "+e);this.displayObject&&this.displayObject.addChildAt(this.skeleton,0),s=isNaN(s)?.5*this.width:s,i=isNaN(i)?.5*this.height:i,this.skeleton.pos(s,i),this.isLoop||this.skeleton.once(Laya.Event.STOPPED,this,this.completeHandler),this.skeleton.play(null==e?0:e,this.isLoop);let n=this.m_data&&this.m_data.loadComplete;n&&n.run()}completeHandler(){this.handler&&this.handler.run(),this.isOverRemove&&this.hide()}PlayAni(e,s=!0,i=null){this.skeleton?(this.skeleton.play(e,s),this.handler=i,s||this.skeleton.once(Laya.Event.STOPPED,this,this.completeHandler)):t.Logger.debug(this,"=====>skeleton is null.")}get isShow(){return this.visible&&null!=this.skeleton}hide(){super.hide(),this.spineName=null,this.isLoop=!0,this.isOverRemove=!1,this.handler=null,this.visible=!1,this._iconObject&&(this._iconObject.visible=!1),null!=this.skeleton&&(this.skeleton.removeSelf(),this.skeleton.off(Laya.Event.STOPPED,this,this.completeHandler,!1),this.skeleton=null),null!=this.iRes&&(this.iRes.Dispose(),this.iRes=null),this.displayObject&&this.displayObject.removeChildren(),this._isLoad=!1}};t.Icon=class extends e{constructor(){super()}InitUI(){this.touchable=!1,this._iconObject instanceof fgui.GLoader&&(this._iconObject.icon="")}show(t){super.show(t),t instanceof Laya.Texture||(t?this.setIcon(t):this.hide())}set url(t){if(t){let e=fgui.UIPackage.getItemByURL(t),s=e.owner.name+"|"+e.name;this.setIcon(s)}else this.hide()}get url(){return this._iconUrl}setIcon(t,e=null){if(this._iconUrl=t,t)if(-1!=t.indexOf("|")){let e=t.split("|");this.setSheet(e[0],e[1])}else this.icon=t;else e&&e.run(),this.hide()}setSheet(e,s,i=t.UrlUtils.UI){t.LoadQueue.Inst.loadFguiPkg(e,i,Laya.Handler.create(this,this.onloadSheetComplete,[e,s]))}onloadSheetComplete(e,s,i){i.getRes(s)?this.icon=t.PanelRegister.getUrl(e,s):i.loadResName(s,Laya.Handler.create(this,(e,s)=>{this.icon=t.PanelRegister.getUrl(e,s)},[e,s]))}set texture(t){this._iconObject instanceof fgui.GLoader&&this._iconObject.onExternalLoadSuccess(t)}get texture(){return this._iconObject instanceof fgui.GLoader?this._iconObject.content.texture:null}hide(){super.hide(),this.icon="",this._iconUrl=""}};t.EButton=class extends e{constructor(){super(),this.m_param=null,this.playSound=!0}breath(t=1.2){fgui.GTween.to(1,t,.6).setTarget(this).setEase(fgui.EaseType.SineInOut).setRepeat(-1,!0).onUpdate(t=>{this.setScale(t.value.x,t.value.x)},this)}stopBreath(){this.setScale(1,1),fgui.GTween.kill(this)}InitUI(){super.InitUI(),this.c1=this.getController("c1"),this._iconObject&&(this._iconObject.touchable=!1),this._titleObject&&(this._titleObject.touchable=!1)}show(t){super.show(t),this.m_param=t}get Data(){return this.m_param}setTooltips(t){this.off(Laya.Event.ROLL_OVER,this,this.rollOver),this.off(Laya.Event.ROLL_OUT,this,this.rollOut),this._tooltips=t,this._tooltips&&(this.on(Laya.Event.ROLL_OVER,this,this.rollOver),this.on(Laya.Event.ROLL_OUT,this,this.rollOut))}rollOver(){Laya.timer.once(100,this,this.showTooltip)}rollOut(){Laya.timer.clear(this,this.showTooltip),fgui.GRoot.inst.hideTooltips()}showTooltip(t=null){}set selectedPage(t){this.c1=this.c1||this.getController("c1"),null!=this.c1&&(this.c1.selectedPage=t),this.updateState()}get selectedPage(){return this.c1&&this.c1.selectedPage}set selectedIndex(t){this.c1&&(this.c1.selectedIndex=t),this.updateState()}get selectedIndex(){return this.c1?this.c1.selectedIndex:0}updateState(){}toTop(t){t=t||this,this.numChildren>1&&-1!=this.getChildIndex(t)&&this.setChildIndex(t,this.numChildren-1)}toBottom(t){t=t||this,-1!=this.getChildIndex(t)&&this.setChildIndex(t,0)}get allVisible(){return this.internalVisible&&this.internalVisible2&&this.internalVisible3}showScaleEffect(t){null!=t&&fgui.GTween.to3(0,0,0,1,1,1,.3).setTarget(t).setEase(fgui.EaseType.SineInOut).onUpdate((function(e){t.setScale(e.value.x,e.value.y),t.alpha=e.value.z})).onComplete((function(){}))}get privoGlobalPoint(){return this.localToGlobal(Math.ceil(this.pivotX*this.width),Math.ceil(this.pivotY*this.height))}RemoveListener(){super.RemoveListener(),this.off(Laya.Event.ROLL_OVER,this,this.rollOver),this.off(Laya.Event.ROLL_OUT,this,this.rollOut)}hide(){super.hide(),this.m_param=null,fgui.GTween.kill(this),Laya.Tween.clearAll(this)}}}(long||(long={})),function(t){function CheckComponent(t,e="show",s=null){if(null==t||!e)return;let i;for(let a=t.numChildren-1;a>=0;a--)i=t.getChildAt(a),i instanceof fgui.GList?CheckEGlistCompoent(i,e,s):instanceOfIComponet(i)&&i.canCallShow?null!=s?i[e](s):i[e]():i.numChildren>0&&CheckComponent(i,e,s)}function CheckEGlistCompoent(e,s="show",i=null){let a=e[t.EGList.EGLIST];null!=a?null!=i?a[s](i):a[s]():e instanceof fgui.GList&&CheckComponent(e,s,i)}function instanceOfIComponet(t){return"I-AM-IComponent"==t.discriminator}t.CheckComponent=CheckComponent,t.CheckEGlistCompoent=CheckEGlistCompoent,t.instanceOfIComponet=instanceOfIComponet}(long||(long={})),function(t){class e extends t.TComponent{constructor(){super(),this.discriminator2="I-AM-IListItem",this._btns=null,this._isFocus=!1}onConstruct(){super.onConstruct(),this.AddListener()}InitFairyGui(){this._btns=new Array,t.FairyUtils.setVar(this,this,this._btns)}show(t){this.m_param=t}set isFocus(t){this._isFocus=t}get isFocus(){return this._isFocus}globalIsIn(t=null){return this.globalIsInRange(t)}globalIsInRange(e=null,s=null){return t.ObjectUtils.globalIsInRange(e,s,this)}hide(){super.hide()}}t.TListItem=e}(long||(long={})),function(t){class e extends Laya.Point{GC(){t.ObjectPools.Inst.gcObj(e.KEY,this)}Reset(){}static GCArray(t){if(null==t){for(const e of t)e.GC();t.length=0}}}e.KEY="TPoint",t.TPoint=e}(long||(long={})),function(t){class e{}e.ON_ACTIVE="ON_ACTIVE",e.ON_SHOW_VIEW="ON_SHOW_VIEW",e.ON_HIDE_VIEW="ON_HIDE_VIEW",e.SHOW_BANNER="SHOW_BANNER",e.HIDE_BANNER="HIDE_BANNER",e.UPDATE_BANNER="UPDATE_BANNER",e.SHOW_INSERT="SHOW_INSERT",e.HIDE_INSERT="HIDE_INSERT",e.SHOW_TIP="SHOW_TIP",e.SKIP_DAY="UIGameEvent.skipDay",e.CLICK_LIST_BUTTON="CLICK_LIST_BUTTON",e.STOP_RECORD="STOP_RECORD",e.SHARE_FAIL="SHARE_FAIL",e.GET_MENU_BUTTON="GET_MENU_BUTTON",t.UIGameEvent=e}(long||(long={})),function(t){class e{constructor(){}static listEffect(t,e=200,s=0,i=0){let a=null;for(let n=0;n<t.numChildren;n++)a=t.getChildAt(n),a.alpha=0,Laya.Tween.clearTween(a),Laya.Tween.to(a,{alpha:1},e,null,null,i+n*s)}static itemEffect(t,e){t.alpha=.5,Laya.Tween.clearTween(t),Laya.Tween.to(t,{alpha:1},e,null,null)}static itemEffectReverse(t,e){t.alpha=1,Laya.Tween.clearTween(t),Laya.Tween.to(t,{alpha:.5},e,null,null)}static openWindowEffect(t,e=null,s=null,i=null,a=!1){fgui.GTween.kill(t),t.scaleX=t.scaleY=.3,t.alpha=1;let n=t.viewWidth,r=t.viewHeight;t.x=.5*(n-t.scaleX*n),t.y=.5*(r-t.scaleY*r);function onUpdate(e){t.scaleX=e.value.x,t.scaleY=e.value.y,t.x=.5*(n-t.scaleX*n),t.y=.5*(r-t.scaleY*r)}fgui.GTween.to2(.3,.3,1.05,1.05,.3).setTarget(t,null).onUpdate(onUpdate,null).onComplete((function(){fgui.GTween.to2(1.05,1.05,.98,.98,.3).setTarget(t,null).onUpdate(onUpdate,null).onComplete((function(){fgui.GTween.to2(.98,.98,1,1,.2).setTarget(t,null).onUpdate(onUpdate,null).onComplete((function(){fgui.GTween.kill(t),null!=e&&e.apply(s,i)}),null)}),null)}),null)}static closeWindowEffect(t,e=null,s=null,i=null,a=!1){if(t){if(!a&&t.isWindowEffect)return;a&&fgui.GTween.kill(t),t.alpha=1,t.scaleX=t.scaleY=1;let n=t.width,r=t.height;fgui.GTween.to3(1,1,1,.8,.8,0,.3).setTarget(t,this).onUpdate((function(e){t.scaleX=e.value.x,t.scaleY=e.value.y,t.alpha=e.value.z,t.x=.5*(Laya.Browser.width-t.scaleX*n),t.y=.5*(Laya.Browser.height-t.scaleY*r)}),this).onComplete((function(){fgui.GTween.kill(t),null!=e&&e.apply(s,i)}),this)}}static FlyPlaceGoldEffect(e,s,i,a,n,r,l,o=800,h=1,c=50,u=null){let d=Math.abs(n-l),g=0,m=d/o;for(var p=0;p<h;p++){var f=fgui.UIPackage.createObject(s,i);f.setPivot(.5,.5,!0),f.touchable=!1,e.addChild(f);let o=[],h=t.MathUtil.makeRandom(0,2*c)-c,u=t.MathUtil.makeRandom(0,2*c)-c;f.x=a+h,f.y=n+u,o.push(new Laya.Point(f.x,f.y)),o.push(new Laya.Point(a+2*h,l+.5*(n-l))),o.push(new Laya.Point(r,l)),g=Math.abs(f.y-l),new t.Bezier2D(f,g/m,5*(d-g),o).start()}u&&Laya.timer.once(o,this,()=>{u&&u.run()})}static PlayTarget(t,s,i,a=null,n=700,r="coin"){if(!s||!i||s.isDisposed||i.isDisposed)return;let l=s.pivotAsAnchor?s.localToGlobal(0,0):s.localToGlobal(.5*s.width,.5*s.height),o=i.pivotAsAnchor?i.localToGlobal(0,0):i.localToGlobal(.5*i.width,.5*i.height);e.PlayGold(t,l.x,l.y,50,o.x,o.y,n,a,r)}static PlayGold(s,i=.5*t.GlobalConfig.viewWidth,a=.5*t.GlobalConfig.viewHeight,n=50,r=0,l=0,o=700,h=null,c="coin"){if(s<=0)return;0==r&&(r=t.GlobalConfig.viewWidth-(t.GlobalConfig.width-571-25),l=70);let u=s>20?20:s;e.FlyPlaceGoldEffect(t.GameLayer.topLayer,"common",c,Math.ceil(i),Math.ceil(a),Math.ceil(r),Math.ceil(l),o,u,n,h)}}t.EffectUtil=e}(long||(long={})),function(t){t.FairyUtils=class{static setVar(e,s,i=null){if(e&&null!=e&&null!=s){let a;for(let n=0;n<e.numChildren;n++)if(a=e.getChildAt(n),"icon"!=a.name&&"title"!=a.name){if(null!=s&&(s[a.name]=a),a instanceof fgui.GTextField&&a.font);else if(a.name&&0==a.name.indexOf("eglist_")&&a instanceof fgui.GList)s[a.name]=new t.EGList(a,s);else if(null!=i&&a instanceof fgui.GButton){if(a.name&&0==a.name.indexOf("spine_")){a.name.indexOf("_")}i.push(a)}a instanceof fgui.GComponent&&this.setVar(a,null,i)}}}}}(long||(long={})),function(t){class e{constructor(){}static GetTemplateUrl(t){return e.TEMPLATE+t+e.resLm}static GetMusic(t,s=!1){return""==t?null:s||window.conch?e.MUSIC+t+e.resWav:e.MUSIC+t+e.resMP3}static GetSpineUrl(t){return e.SPINE+t+e.resSk}static getFairyPkg(t,s=e.UI){return s+t}}e.RES="res/",e.MUSIC="sound/",e.TEMPLATE=e.RES+"template/",e.UI=e.RES+"fgui/",e.SPINE=e.RES+"spine/",e.resPng=".png",e.resJpg=".jpg",e.resMP3=".mp3",e.resWav=".wav",e.resJson=".json",e.resLm=".lm",e.resLh=".lh",e.resLs=".ls",e.resSk=".sk",e.resLmat=".lmat",e.resAtlas=".atlas",e.version="?"+(new Date).getTime().toString(),t.UrlUtils=e}(long||(long={}));